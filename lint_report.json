[
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\electron.vite.config.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\eslint.config.mjs",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\postcss.config.js",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\main\\index.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 362,
        "column": 19,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 362,
        "endColumn": 22,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [11316, 11319], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [11316, 11319], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 416,
        "column": 19,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 416,
        "endColumn": 22,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [12845, 12848], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [12845, 12848], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 437,
        "column": 19,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 437,
        "endColumn": 22,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [13479, 13482], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [13479, 13482], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 455,
        "column": 19,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 455,
        "endColumn": 22,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [14081, 14084], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [14081, 14084], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 463,
        "column": 1,
        "nodeType": "FunctionDeclaration",
        "messageId": "missingReturnType",
        "endLine": 463,
        "endColumn": 32
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 473,
        "column": 1,
        "nodeType": "FunctionDeclaration",
        "messageId": "missingReturnType",
        "endLine": 473,
        "endColumn": 35
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 483,
        "column": 19,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 483,
        "endColumn": 22,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [14889, 14892], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [14889, 14892], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 492,
        "column": 25,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 492,
        "endColumn": 28,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [15386, 15389], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [15386, 15389], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 493,
        "column": 25,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 493,
        "endColumn": 28,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [15450, 15453], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [15450, 15453], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 494,
        "column": 25,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 494,
        "endColumn": 28,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [15529, 15532], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [15529, 15532], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 495,
        "column": 25,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 495,
        "endColumn": 28,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [15608, 15611], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [15608, 15611], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 496,
        "column": 25,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 496,
        "endColumn": 28,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [15679, 15682], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [15679, 15682], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 497,
        "column": 25,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 497,
        "endColumn": 28,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [15743, 15746], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [15743, 15746], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 509,
        "column": 1,
        "nodeType": "FunctionDeclaration",
        "messageId": "missingReturnType",
        "endLine": 509,
        "endColumn": 36
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 580,
        "column": 1,
        "nodeType": "FunctionDeclaration",
        "messageId": "missingReturnType",
        "endLine": 580,
        "endColumn": 36
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 646,
        "column": 1,
        "nodeType": "FunctionDeclaration",
        "messageId": "missingReturnType",
        "endLine": 646,
        "endColumn": 35
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 650,
        "column": 19,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 650,
        "endColumn": 22,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [20181, 20184], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [20181, 20184], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 659,
        "column": 25,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 659,
        "endColumn": 28,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [20635, 20638], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [20635, 20638], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 660,
        "column": 25,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 660,
        "endColumn": 28,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [20698, 20701], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [20698, 20701], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 661,
        "column": 25,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 661,
        "endColumn": 28,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [20761, 20764], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [20761, 20764], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 662,
        "column": 25,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 662,
        "endColumn": 28,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [20824, 20827], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [20824, 20827], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 679,
        "column": 21,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 679,
        "endColumn": 24,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [21409, 21412], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [21409, 21412], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 689,
        "column": 19,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 689,
        "endColumn": 22,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [21739, 21742], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [21739, 21742], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'SchemaType' is assigned a value but never used.",
        "line": 699,
        "column": 69,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 699,
        "endColumn": 79
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 743,
        "column": 21,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 743,
        "endColumn": 24,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [23521, 23524], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [23521, 23524], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": null,
        "message": "Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').",
        "line": 831,
        "column": 7,
        "severity": 1,
        "nodeType": null,
        "fix": { "range": [26486, 26548], "text": " " }
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 833,
        "column": 33,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 833,
        "endColumn": 36,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [26631, 26634], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [26631, 26634], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": null,
        "message": "Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').",
        "line": 834,
        "column": 11,
        "severity": 1,
        "nodeType": null,
        "fix": { "range": [26651, 26713], "text": " " }
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 837,
        "column": 42,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 837,
        "endColumn": 45,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [26815, 26818], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [26815, 26818], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 869,
        "column": 24,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 869,
        "endColumn": 27,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [28234, 28237], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [28234, 28237], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": null,
        "message": "Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').",
        "line": 879,
        "column": 9,
        "severity": 1,
        "nodeType": null,
        "fix": { "range": [28704, 28766], "text": " " }
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 881,
        "column": 23,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 881,
        "endColumn": 26,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [28814, 28817], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [28814, 28817], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 892,
        "column": 23,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 892,
        "endColumn": 26,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [29155, 29158], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [29155, 29158], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 947,
        "column": 25,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 947,
        "endColumn": 28,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [30825, 30828], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [30825, 30828], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'e' is defined but never used.",
        "line": 977,
        "column": 18,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 977,
        "endColumn": 19
      },
      {
        "ruleId": null,
        "message": "Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').",
        "line": 998,
        "column": 15,
        "severity": 1,
        "nodeType": null,
        "fix": { "range": [32568, 32630], "text": " " }
      },
      {
        "ruleId": null,
        "message": "Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').",
        "line": 1013,
        "column": 15,
        "severity": 1,
        "nodeType": null,
        "fix": { "range": [33263, 33325], "text": " " }
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 1020,
        "column": 25,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 1020,
        "endColumn": 28,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [33642, 33645], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [33642, 33645], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 1032,
        "column": 21,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 1032,
        "endColumn": 24,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [33976, 33979], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [33976, 33979], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 1064,
        "column": 19,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 1064,
        "endColumn": 22,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [35088, 35091], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [35088, 35091], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 545,
        "column": 43,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 545,
        "endColumn": 46,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [17011, 17014], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [17011, 17014], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ],
        "suppressions": [{ "kind": "directive", "justification": "" }]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 605,
        "column": 43,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 605,
        "endColumn": 46,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [18765, 18768], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [18765, 18768], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ],
        "suppressions": [{ "kind": "directive", "justification": "" }]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 731,
        "column": 50,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 731,
        "endColumn": 53,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [23160, 23163], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [23160, 23163], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ],
        "suppressions": [{ "kind": "directive", "justification": "" }]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 779,
        "column": 20,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 779,
        "endColumn": 23,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [24687, 24690], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [24687, 24690], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ],
        "suppressions": [{ "kind": "directive", "justification": "" }]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 877,
        "column": 59,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 877,
        "endColumn": 62,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [28601, 28604], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [28601, 28604], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ],
        "suppressions": [{ "kind": "directive", "justification": "" }]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 901,
        "column": 21,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 901,
        "endColumn": 24,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [29456, 29459], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [29456, 29459], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ],
        "suppressions": [{ "kind": "directive", "justification": "" }]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 970,
        "column": 31,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 970,
        "endColumn": 34,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [31686, 31689], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [31686, 31689], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ],
        "suppressions": [{ "kind": "directive", "justification": "" }]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 1048,
        "column": 45,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 1048,
        "endColumn": 48,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [34534, 34537], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [34534, 34537], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ],
        "suppressions": [{ "kind": "directive", "justification": "" }]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 1057,
        "column": 46,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 1057,
        "endColumn": 49,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [34841, 34844], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [34841, 34844], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ],
        "suppressions": [{ "kind": "directive", "justification": "" }]
      }
    ],
    "errorCount": 35,
    "fatalErrorCount": 0,
    "warningCount": 5,
    "fixableErrorCount": 0,
    "fixableWarningCount": 5,
    "source": "import {\n  app,\n  shell,\n  BrowserWindow,\n  ipcMain,\n  Tray,\n  Menu,\n  globalShortcut,\n  nativeImage,\n  protocol,\n  session,\n  Session\n} from 'electron'\nimport { join } from 'path'\nimport { electronApp, optimizer, is } from '@electron-toolkit/utils'\nimport icon from '../../resources/icon.png?asset'\nimport trayIcon from '../../resources/tray.png?asset'\nimport fs from 'fs'\nimport path from 'path'\nimport crypto from 'crypto'\n\n// Register custom protocol privileges (MUST be done before app is ready)\nprotocol.registerSchemesAsPrivileged([\n  {\n    scheme: 'gemini-media',\n    privileges: {\n      standard: true,\n      secure: true,\n      supportFetchAPI: true,\n      bypassCSP: true,\n      stream: true\n    }\n  }\n])\n\n// Hide automation flags\napp.commandLine.appendSwitch('disable-blink-features', 'AutomationControlled')\n\n// Spoof UA to allow Google Login - use Firefox UA as it often bypasses Electron detection\n// (User suggested Firefox 70, but using 133 to avoid 'browser not supported' errors)\nconst MAC_UA =\n  'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:133.0) Gecko/20100101 Firefox/133.0'\nconst WIN_UA = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:133.0) Gecko/20100101 Firefox/133.0'\nconst CHROME_UA = process.platform === 'win32' ? WIN_UA : MAC_UA\napp.userAgentFallback = CHROME_UA\n\nlet tray: Tray | null = null\nlet mainWindow: BrowserWindow | null = null\nlet isQuitting = false\n\nfunction createWindow(): void {\n  // Create the browser window.\n  mainWindow = new BrowserWindow({\n    width: 1000,\n    height: 700,\n    minWidth: 800,\n    minHeight: 600,\n    show: false,\n    autoHideMenuBar: true,\n    ...(process.platform === 'linux' ? { icon } : {}),\n    ...(process.platform === 'darwin' ? { titleBarStyle: 'hiddenInset' } : {}),\n    ...(process.platform === 'win32'\n      ? {\n          titleBarStyle: 'hidden',\n          titleBarOverlay: {\n            color: '#00000000',\n            symbolColor: '#ffffff',\n            height: 30\n          }\n        }\n      : {}),\n    webPreferences: {\n      preload: join(__dirname, '../preload/index.js'),\n      sandbox: false,\n      webviewTag: true,\n      contextIsolation: true,\n      webSecurity: false // Still needed for some things, but protocol handles images now\n    }\n  })\n\n  mainWindow.on('ready-to-show', () => {\n    mainWindow?.show()\n  })\n\n  mainWindow.webContents.setWindowOpenHandler((details) => {\n    shell.openExternal(details.url)\n    return { action: 'deny' }\n  })\n\n  // Close behavior: hide instead of quit on Mac/Win if desired\n  mainWindow.on('close', (event) => {\n    if (!isQuitting) {\n      event.preventDefault()\n      mainWindow?.hide()\n    }\n    return false\n  })\n\n  // HMR for renderer base on electron-vite cli.\n  // Load the remote URL for development or the local html file for production.\n  if (is.dev && process.env['ELECTRON_RENDERER_URL']) {\n    mainWindow.loadURL(process.env['ELECTRON_RENDERER_URL'])\n  } else {\n    mainWindow.loadFile(join(__dirname, '../renderer/index.html'))\n  }\n}\n\nfunction toggleWindow(): void {\n  if (mainWindow?.isVisible()) {\n    mainWindow.hide()\n  } else {\n    mainWindow?.show()\n    mainWindow?.focus()\n  }\n}\n\n// This method will be called when Electron has finished\n// initialization and is ready to create browser windows.\n// Some APIs can only be used after this event occurs.\napp.whenReady().then(() => {\n  // Register 'gemini-media' protocol to serve saved images\n  protocol.handle('gemini-media', (request) => {\n    try {\n      const url = request.url.replace('gemini-media://', '')\n      const decodedUrl = decodeURI(url)\n\n      // Clean up filename: extract last path segment and remove trailing slashes\n      let cleanFilename = decodedUrl.split('/').pop() || decodedUrl\n      cleanFilename = cleanFilename.replace(/\\/+$/, '')\n\n      if (!cleanFilename || cleanFilename.trim() === '') {\n        return new Response('Invalid filename', { status: 400 })\n      }\n\n      const filePath = path.join(app.getPath('userData'), 'images', cleanFilename)\n\n      if (!fs.existsSync(filePath)) {\n        console.warn('[Protocol] File not found:', filePath)\n        return new Response('Not Found', { status: 404 })\n      }\n\n      const data = fs.readFileSync(filePath)\n\n      // Determine mime type based on extension\n      const ext = path.extname(cleanFilename).toLowerCase()\n      let mimeType = 'image/png'\n      if (ext === '.jpg' || ext === '.jpeg') mimeType = 'image/jpeg'\n      if (ext === '.webp') mimeType = 'image/webp'\n      if (ext === '.gif') mimeType = 'image/gif'\n      if (ext === '.svg') mimeType = 'image/svg+xml'\n\n      return new Response(data, {\n        status: 200,\n        headers: {\n          'Content-Type': mimeType,\n          'Content-Length': String(data.length)\n        }\n      })\n    } catch (error) {\n      console.error('[Protocol] Error:', error)\n      return new Response('Internal Error', { status: 500 })\n    }\n  })\n\n  // Set app user model id for windows\n  electronApp.setAppUserModelId('com.electron')\n\n  // Default open or close DevTools by F12 in development\n  // and ignore CommandOrControl + R in production.\n  app.on('browser-window-created', (_, window) => {\n    optimizer.watchWindowShortcuts(window)\n  })\n\n  // IPC test\n  ipcMain.on('ping', () => console.log('pong'))\n\n  // Return platform-appropriate User-Agent\n  ipcMain.handle('gemini:getUserAgent', () => {\n    return CHROME_UA\n  })\n\n  app.on('web-contents-created', (_event, contents) => {\n    // Advanced stealth: Use CDP (Chrome DevTools Protocol) to modify navigator properties\n    // This runs even before preload scripts, effectively hiding the automation flags completely\n    contents.on('did-finish-load', () => {\n      // Optional: extra verify\n    })\n\n    try {\n      if (!contents.debugger.isAttached()) {\n        contents.debugger.attach('1.3')\n      }\n\n      contents.debugger.sendCommand('Page.enable')\n      contents.debugger.sendCommand('Page.addScriptToEvaluateOnNewDocument', {\n        source: `\n                // Overwrite the webdriver property with a getter that returns undefined\n                Object.defineProperty(navigator, 'webdriver', {\n                    get: () => undefined\n                });\n                \n                // Cleanup prototype just in case\n                try {\n                    delete Navigator.prototype.webdriver;\n                } catch(e) {}\n\n                // Remove specific automation flags\n                try {\n                    const key = Object.keys(window).find(key => key.startsWith('cdc_'));\n                    if(key) delete window[key];\n                } catch(e) {}\n            `\n      })\n    } catch (e) {\n      console.error('Failed to attach debugger for stealth:', e)\n    }\n  })\n\n  app.on('ready', () => {\n    // 1. Create Anti-Fingerprinting Preload Script\n    // We write this file dynamically to ensure it exists and has the latest bypass logic\n    const userDataPath = app.getPath('userData')\n    const antiFingerprintPath = join(userDataPath, 'anti-fingerprint.js')\n\n    const antiFingerprintContent = `\n      try {\n        // Remove navigator.webdriver (common automation flag)\n        const newProto = navigator.__proto__;\n        delete newProto.webdriver;\n        navigator.__proto__ = newProto;\n      } catch (e) {}\n\n      try {\n        // Remove Selenium/ChromeDriver markers (cdc_...)\n        const key = Object.keys(window).find(key => key.startsWith('cdc_'));\n        if(key) delete window[key];\n      } catch (e) {}\n    `\n    try {\n      fs.writeFileSync(antiFingerprintPath, antiFingerprintContent)\n    } catch (e) {\n      console.error('Failed to write anti-fingerprint script:', e)\n    }\n\n    // 2. Configure Specific Session with Preload & Headers\n    const geminiSession = session.fromPartition('persist:gemini')\n    try {\n      geminiSession.setPreloads([antiFingerprintPath])\n    } catch (e) {\n      console.error('Failed to set preloads:', e)\n    }\n\n    // Helper to strip headers for anti-fingerprinting\n    const stripHeaders = (sess: Session): void => {\n      sess.webRequest.onBeforeSendHeaders(\n        { urls: ['*://*.google.com/*', '*://*.googleapis.com/*', '*://accounts.google.com/*'] },\n        (details, callback) => {\n          const { requestHeaders } = details\n          delete requestHeaders['Sec-Ch-Ua']\n          delete requestHeaders['Sec-Ch-Ua-Full-Version']\n          delete requestHeaders['Sec-Ch-Ua-Full-Version-List']\n          delete requestHeaders['Sec-Ch-Ua-Mobile']\n          delete requestHeaders['Sec-Ch-Ua-Platform']\n          delete requestHeaders['Sec-Ch-Ua-Platform-Version']\n          callback({ requestHeaders })\n        }\n      )\n    }\n\n    // Apply to default session (safe fallback)\n    stripHeaders(session.defaultSession)\n\n    // Apply to our specific webview partition\n    stripHeaders(geminiSession)\n  })\n\n  createWindow()\n\n  // Create Tray\n  const iconImage = nativeImage.createFromPath(trayIcon)\n  tray = new Tray(iconImage.resize({ width: 16, height: 16 }))\n\n  const contextMenu = Menu.buildFromTemplate([\n    { label: 'Show App', click: () => mainWindow?.show() },\n    { type: 'separator' },\n    {\n      label: 'Quit',\n      click: () => {\n        isQuitting = true\n        app.quit()\n      }\n    }\n  ])\n\n  tray.setToolTip('Gemini Native')\n  tray.setContextMenu(contextMenu)\n  tray.on('click', () => toggleWindow())\n\n  // Global Shortcut\n  globalShortcut.register('CommandOrControl+Shift+G', () => {\n    toggleWindow()\n  })\n\n  app.on('activate', function () {\n    // On macOS it's common to re-create a window in the app when the\n    // dock icon is clicked and there are no other windows open.\n    if (BrowserWindow.getAllWindows().length === 0) createWindow()\n  })\n})\n\n// Quit when all windows are closed, except on macOS. There, it's common\n// for applications and their menu bar to stay active until the user quits\n// explicitly with Cmd + Q.\napp.on('window-all-closed', () => {\n  if (process.platform !== 'darwin') {\n    app.quit()\n  }\n})\n\napp.on('before-quit', () => {\n  isQuitting = true\n})\n\n// Helper to save image to disk\n// Helper to save image/video to disk\nipcMain.handle('gemini:saveImage', async (_event, { base64Data }) => {\n  try {\n    const matches = base64Data.match(/^data:([^;]+);base64,([\\s\\S]+)$/)\n    if (!matches) throw new Error('Invalid base64 data')\n\n    const mimeType = matches[1]\n    const data = matches[2]\n    const buffer = Buffer.from(data, 'base64')\n\n    // Determine extension\n    let ext = 'png'\n    if (mimeType === 'image/jpeg') ext = 'jpg'\n    if (mimeType === 'image/webp') ext = 'webp'\n    if (mimeType === 'application/pdf') ext = 'pdf'\n    // Video support\n    if (mimeType === 'video/mp4') ext = 'mp4'\n    if (mimeType === 'video/webm') ext = 'webm'\n    if (mimeType === 'video/quicktime') ext = 'mov'\n\n    // Setup directory\n    const userDataPath = app.getPath('userData')\n    const imagesDir = path.join(userDataPath, 'images')\n\n    if (!fs.existsSync(imagesDir)) {\n      fs.mkdirSync(imagesDir, { recursive: true })\n    }\n\n    // Generate filename\n    const filename = `${Date.now()}-${crypto.randomBytes(4).toString('hex')}.${ext}`\n    const filePath = path.join(imagesDir, filename)\n\n    // Write file\n    await fs.promises.writeFile(filePath, buffer)\n\n    // Return protocol URL (gemini-media://filename)\n    return { success: true, path: `gemini-media://${filename}` }\n  } catch (error: any) {\n    console.error('Failed to save media:', error)\n    return { success: false, error: error.message }\n  }\n})\n\n// Helper to list saved media\nipcMain.handle('gemini:listImages', async () => {\n  try {\n    const userDataPath = app.getPath('userData')\n    const imagesDir = path.join(userDataPath, 'images')\n\n    if (!fs.existsSync(imagesDir)) {\n      return { success: true, images: [] }\n    }\n\n    const files = await fs.promises.readdir(imagesDir)\n\n    // Filter for valid image/video extensions\n    const validExtensions = new Set([\n      '.jpg',\n      '.jpeg',\n      '.png',\n      '.gif',\n      '.webp',\n      '.svg', // Images\n      '.mp4',\n      '.webm',\n      '.mov',\n      '.avi' // Videos\n    ])\n    const validFiles = files.filter((file) => {\n      const ext = path.extname(file).toLowerCase()\n      return validExtensions.has(ext)\n    })\n\n    // Get stats for sorting and exclude empty files\n    const fileStats = (\n      await Promise.all(\n        validFiles.map(async (file) => {\n          const filePath = path.join(imagesDir, file)\n          const stats = await fs.promises.stat(filePath)\n          // Filter out 0 byte files\n          if (stats.size === 0) return null\n          return { file, mtime: stats.mtimeMs }\n        })\n      )\n    ).filter(Boolean) as { file: string; mtime: number }[]\n\n    // Sort by newest first\n    fileStats.sort((a, b) => b.mtime - a.mtime)\n\n    const imageUrls = fileStats.map((f) => `gemini-media://${f.file}`)\n    return { success: true, images: imageUrls }\n  } catch (error: any) {\n    console.error('Failed to list media:', error)\n    return { success: false, error: error.message }\n  }\n})\n\n// Delete specific image\nipcMain.handle('gemini:deleteImage', async (_event, { filename }) => {\n  try {\n    const userDataPath = app.getPath('userData')\n    const filePath = path.join(userDataPath, 'images', filename)\n\n    // Security check: ensure file is within images dir\n    if (!filePath.startsWith(path.join(userDataPath, 'images'))) {\n      throw new Error('Access denied')\n    }\n\n    if (fs.existsSync(filePath)) {\n      await fs.promises.unlink(filePath)\n    }\n    return { success: true }\n  } catch (error: any) {\n    console.error('Failed to delete image:', error)\n    return { success: false, error: error.message }\n  }\n})\n\n// Delete ALL images (Nuclear Option)\nipcMain.handle('gemini:deleteAllImages', async () => {\n  try {\n    const userDataPath = app.getPath('userData')\n    const imagesDir = path.join(userDataPath, 'images')\n\n    if (fs.existsSync(imagesDir)) {\n      // Remove the entire directory and recreate it\n      await fs.promises.rm(imagesDir, { recursive: true, force: true })\n      await fs.promises.mkdir(imagesDir, { recursive: true })\n    }\n    return { success: true }\n  } catch (error: any) {\n    console.error('Failed to delete all images:', error)\n    return { success: false, error: error.message }\n  }\n})\n\n// Helper function for Image Generation\n// Helper to list models (internal use)\nasync function listModelsHelper(apiKey: string) {\n  const response = await fetch(\n    `https://generativelanguage.googleapis.com/v1beta/models?key=${apiKey}`\n  )\n  if (!response.ok) return []\n  const data = await response.json()\n  return data.models || []\n}\n\n// Helper function for Image Generation\nasync function generateImageHelper(\n  apiKey: string,\n  modelId: string,\n  prompt: string,\n  aspectRatio?: string,\n  personGeneration?: string\n) {\n  // 1. Try the requested model first\n  try {\n    return await attemptGenerateImage(apiKey, modelId, prompt, aspectRatio, personGeneration)\n  } catch (error: any) {\n    // 2. If 404 (Not Found), try to find a valid fallback\n    if (error.message.includes('404') || error.message.includes('not found')) {\n      console.warn(`[Imagen] Model ${modelId} not found. Searching for available alternatives...`)\n\n      const models = await listModelsHelper(apiKey)\n      // Look for any model with 'imagen' in the name\n      // Preferred order: imagen-4, 3.0-generate-002, 3.0-generate-001, 3.0-fast, 2.0, any imagen\n      const fallback =\n        models.find((m: any) => m.name.includes('imagen-4')) ||\n        models.find((m: any) => m.name.includes('imagen-3.0-generate-002')) ||\n        models.find((m: any) => m.name.includes('imagen-3.0-generate-001')) ||\n        models.find((m: any) => m.name.includes('imagen-3.0-fast')) ||\n        models.find((m: any) => m.name.includes('imagen-2')) ||\n        models.find((m: any) => m.name.includes('imagen'))\n\n      if (fallback) {\n        const newModelId = fallback.name.replace('models/', '')\n        console.log(`[Imagen] Retrying with fallback model: ${newModelId}`)\n        return await attemptGenerateImage(apiKey, newModelId, prompt, aspectRatio, personGeneration)\n      }\n    }\n    throw error\n  }\n}\n\nasync function attemptGenerateImage(\n  apiKey: string,\n  modelId: string,\n  prompt: string,\n  aspectRatio?: string,\n  personGeneration?: string\n) {\n  const url = `https://generativelanguage.googleapis.com/v1beta/models/${modelId}:predict?key=${apiKey}`\n\n  const requestBody = {\n    instances: [\n      {\n        prompt: prompt\n      }\n    ],\n    parameters: {\n      sampleCount: 1,\n      aspectRatio: aspectRatio || '1:1',\n      personGeneration: personGeneration || 'allow_adult'\n    }\n  }\n\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(requestBody)\n  })\n\n  if (!response.ok) {\n    const errorText = await response.text()\n    throw new Error(`Imagen API Error: ${response.status} ${response.statusText} - ${errorText}`)\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const data = (await response.json()) as any\n\n  if (data.predictions && data.predictions.length > 0) {\n    const prediction = data.predictions[0]\n    const b64 = prediction.bytesBase64Encoded\n    const mimeType = prediction.mimeType || 'image/png'\n\n    const buffer = Buffer.from(b64, 'base64')\n    let ext = 'png'\n    if (mimeType === 'image/jpeg') ext = 'jpg'\n    if (mimeType === 'image/webp') ext = 'webp'\n\n    const userDataPath = app.getPath('userData')\n    const imagesDir = path.join(userDataPath, 'images')\n    if (!fs.existsSync(imagesDir)) {\n      await fs.promises.mkdir(imagesDir, { recursive: true })\n    }\n\n    const filename = `${Date.now()}-${crypto.randomBytes(4).toString('hex')}.${ext}`\n    const filePath = path.join(imagesDir, filename)\n\n    await fs.promises.writeFile(filePath, buffer)\n\n    return {\n      success: true,\n      path: `gemini-media://${filename}`,\n      base64: `data:${mimeType};base64,${b64}`,\n      mimeType\n    }\n  } else {\n    throw new Error('No predictions returned from Imagen')\n  }\n}\n\n// Helper function for Video Generation\nasync function attemptGenerateVideo(apiKey: string, modelId: string, prompt: string) {\n  const url = `https://generativelanguage.googleapis.com/v1beta/models/${modelId}:predict?key=${apiKey}`\n\n  const requestBody = {\n    instances: [\n      {\n        prompt: prompt\n      }\n    ]\n  }\n\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(requestBody)\n  })\n\n  if (!response.ok) {\n    const errorText = await response.text()\n    throw new Error(`Veo API Error: ${response.status} ${response.statusText} - ${errorText}`)\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const data = (await response.json()) as any\n\n  if (data.predictions && data.predictions.length > 0) {\n    const prediction = data.predictions[0]\n\n    const b64 =\n      prediction.bytesBase64Encoded || (prediction.video && prediction.video.bytesBase64Encoded)\n    const mimeType =\n      prediction.mimeType || (prediction.video && prediction.video.mimeType) || 'video/mp4'\n\n    if (!b64) {\n      throw new Error('No video data found in Veo prediction')\n    }\n\n    const buffer = Buffer.from(b64, 'base64')\n    let ext = 'mp4'\n    if (mimeType === 'video/webm') ext = 'webm'\n    if (mimeType === 'video/quicktime') ext = 'mov'\n    if (mimeType === 'video/avi') ext = 'avi'\n\n    const userDataPath = app.getPath('userData')\n    const imagesDir = path.join(userDataPath, 'images')\n    if (!fs.existsSync(imagesDir)) {\n      await fs.promises.mkdir(imagesDir, { recursive: true })\n    }\n\n    const filename = `${Date.now()}-${crypto.randomBytes(4).toString('hex')}.${ext}`\n    const filePath = path.join(imagesDir, filename)\n\n    await fs.promises.writeFile(filePath, buffer)\n\n    return {\n      success: true,\n      path: `gemini-media://${filename}`,\n      mimeType\n    }\n  } else {\n    throw new Error('No predictions returned from Veo')\n  }\n}\n\nasync function generateVideoHelper(apiKey: string, modelId: string, prompt: string) {\n  // 1. Try the requested model first\n  try {\n    return await attemptGenerateVideo(apiKey, modelId, prompt)\n  } catch (error: any) {\n    // 2. If 404 (Not Found), try to find a valid fallback\n    if (error.message.includes('404') || error.message.includes('not found')) {\n      console.warn(`[Veo] Model ${modelId} not found. Searching for available alternatives...`)\n\n      const models = await listModelsHelper(apiKey)\n      // Look for any model with 'veo' in the name\n      // Preferred order: veo-3.1, veo-3.0, veo-2.0, any veo\n      const fallback =\n        models.find((m: any) => m.name.includes('veo-3.1')) ||\n        models.find((m: any) => m.name.includes('veo-3.0')) ||\n        models.find((m: any) => m.name.includes('veo-2.0')) ||\n        models.find((m: any) => m.name.includes('veo'))\n\n      if (fallback) {\n        const newModelId = fallback.name.replace('models/', '')\n        console.log(`[Veo] Retrying with fallback model: ${newModelId}`)\n        return await attemptGenerateVideo(apiKey, newModelId, prompt)\n      }\n    }\n    throw error\n  }\n}\n// Generate Image (Imagen 4.0 / 3.0)\nipcMain.handle(\n  'gemini:generate-image',\n  async (_event, { apiKey, modelId, prompt, aspectRatio, personGeneration }) => {\n    try {\n      return await generateImageHelper(apiKey, modelId, prompt, aspectRatio, personGeneration)\n    } catch (error: any) {\n      console.error('Failed to generate image:', error)\n      return { success: false, error: error.message }\n    }\n  }\n)\n// Generate Video (Veo)\nipcMain.handle('gemini:generate-video', async (_event, { apiKey, modelId, prompt }) => {\n  try {\n    return await generateVideoHelper(apiKey, modelId, prompt)\n  } catch (error: any) {\n    console.error('Failed to generate video:', error)\n    return { success: false, error: error.message }\n  }\n})\n\nipcMain.handle(\n  'gemini:chat',\n  async (_event, { apiKey, modelName, message, history, systemInstruction }) => {\n    try {\n      const { GoogleGenerativeAI, HarmCategory, HarmBlockThreshold, SchemaType } =\n        await import('@google/generative-ai')\n      const genAI = new GoogleGenerativeAI(apiKey)\n\n      const safetySettings = [\n        {\n          category: HarmCategory.HARM_CATEGORY_HARASSMENT,\n          threshold: HarmBlockThreshold.BLOCK_NONE\n        },\n        {\n          category: HarmCategory.HARM_CATEGORY_HATE_SPEECH,\n          threshold: HarmBlockThreshold.BLOCK_NONE\n        },\n        {\n          category: HarmCategory.HARM_CATEGORY_SEXUALLY_EXPLICIT,\n          threshold: HarmBlockThreshold.BLOCK_NONE\n        },\n        {\n          category: HarmCategory.HARM_CATEGORY_DANGEROUS_CONTENT,\n          threshold: HarmBlockThreshold.BLOCK_NONE\n        }\n      ]\n\n      const model = genAI.getGenerativeModel({\n        model: modelName,\n        systemInstruction: systemInstruction || undefined,\n        safetySettings\n      })\n\n      // Ensure roles are valid before starting chat (basic sanitization)\n      // Gemini 1.5 models prefer 'user' and 'model' roles\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const sanitizedHistory = history.map((msg: any) => ({\n        role: msg.role === 'assistant' ? 'model' : msg.role,\n        parts: msg.parts\n      }))\n\n      const chat = model.startChat({\n        history: sanitizedHistory\n      })\n\n      const result = await chat.sendMessage(message)\n      const response = await result.response\n      return { success: true, text: response.text() }\n    } catch (error: any) {\n      console.error('Gemini API Error:', error)\n      return { success: false, error: error.message || 'Unknown error' }\n    }\n  }\n)\n\nipcMain.handle(\n  'gemini:stream',\n  async (_event, { apiKey, modelName, message, images, history, systemInstruction }) => {\n    try {\n      const { GoogleGenerativeAI, HarmCategory, HarmBlockThreshold, SchemaType } =\n        await import('@google/generative-ai')\n      const genAI = new GoogleGenerativeAI(apiKey)\n\n      const safetySettings = [\n        {\n          category: HarmCategory.HARM_CATEGORY_HARASSMENT,\n          threshold: HarmBlockThreshold.BLOCK_NONE\n        },\n        {\n          category: HarmCategory.HARM_CATEGORY_HATE_SPEECH,\n          threshold: HarmBlockThreshold.BLOCK_NONE\n        },\n        {\n          category: HarmCategory.HARM_CATEGORY_SEXUALLY_EXPLICIT,\n          threshold: HarmBlockThreshold.BLOCK_NONE\n        },\n        {\n          category: HarmCategory.HARM_CATEGORY_DANGEROUS_CONTENT,\n          threshold: HarmBlockThreshold.BLOCK_NONE\n        }\n      ]\n\n      // Define tools for function calling\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const tools: any = [\n        {\n          functionDeclarations: [\n            {\n              name: 'generate_image',\n              description:\n                'Generate an image based on a prompt. Use this when the user asks to draw, create, or generate an image.',\n              parameters: {\n                type: SchemaType.OBJECT,\n                properties: {\n                  prompt: {\n                    type: SchemaType.STRING,\n                    description: 'The description of the image to generate.'\n                  },\n                  aspectRatio: {\n                    type: SchemaType.STRING,\n                    description:\n                      \"Aspect ratio. Options: '1:1', '16:9', '9:16', '4:3', '3:4'. Default '1:1'.\"\n                  }\n                },\n                required: ['prompt']\n              }\n            },\n            {\n              name: 'generate_video',\n              description:\n                'Generate a short video based on a prompt. Use this when the user asks to create or generate a video.',\n              parameters: {\n                type: SchemaType.OBJECT,\n                properties: {\n                  prompt: {\n                    type: SchemaType.STRING,\n                    description: 'The description of the video to generate.'\n                  }\n                },\n                required: ['prompt']\n              }\n            }\n          ]\n        }\n      ]\n\n      const isGemma = modelName.toLowerCase().includes('gemma')\n\n      const model = genAI.getGenerativeModel({\n        model: modelName,\n        systemInstruction: isGemma ? undefined : systemInstruction || undefined,\n        safetySettings,\n        tools: isGemma ? undefined : tools\n      })\n\n      // Process history to hydrate internalUrl images into inlineData\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const processedHistory = await Promise.all(\n        history.map(async (msg: any) => {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          const newParts = (\n            await Promise.all(\n              msg.parts.map(async (part: any) => {\n                if (part.internalUrl) {\n                  try {\n                    const cleanFilename = part.internalUrl.replace('gemini-media://', '')\n                    const filePath = path.join(app.getPath('userData'), 'images', cleanFilename)\n                    if (fs.existsSync(filePath)) {\n                      const data = fs.readFileSync(filePath)\n                      const base64 = data.toString('base64')\n                      const ext = path.extname(cleanFilename).toLowerCase()\n                      let mimeType = 'image/png'\n                      if (ext === '.jpg' || ext === '.jpeg') mimeType = 'image/jpeg'\n                      if (ext === '.webp') mimeType = 'image/webp'\n                      if (ext === '.gif') mimeType = 'image/gif'\n\n                      return {\n                        inlineData: {\n                          mimeType: mimeType,\n                          data: base64\n                        }\n                      }\n                    } else {\n                      console.warn('[IPC] Image file not found, skipping:', filePath)\n                      return null\n                    }\n                  } catch (err) {\n                    console.error('[IPC] Failed to hydrate history image:', err)\n                    return null\n                  }\n                }\n                return part\n              })\n            )\n          ).filter((p: any) => p !== null)\n          return { ...msg, parts: newParts }\n        })\n      )\n\n      // Sanitize: strip any remaining internalUrl fields to prevent API errors\n      // Also ensure roles are valid (gemini 1.5 likes 'user' and 'model')\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const sanitizedHistory = processedHistory.map((msg: any) => ({\n        role: msg.role === 'assistant' ? 'model' : msg.role, // Ensure role mapping\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        parts: msg.parts\n          .map((part: any) => {\n            if (part.internalUrl) {\n              const rest = { ...part }\n              delete rest.internalUrl\n              if (Object.keys(rest).length === 0) {\n                return { text: '[Image removed]' }\n              }\n              return rest\n            }\n            return part\n          })\n          .filter((p: any) => p && (p.text !== undefined || p.inlineData !== undefined))\n      }))\n\n      const chat = model.startChat({\n        history: sanitizedHistory\n      })\n\n      // Construct message parts for current message\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      let msgParts: any[] = []\n\n      if (images && images.length > 0) {\n        // Convert data URLs to inlineData objects\n        // expected data URL format: \"data:image/jpeg;base64,...\"\n        const imageParts = images\n          .map((img) => {\n            // Regex to capture MimeType (group 1) and Base64 Data (group 2)\n            // Use [\\s\\S] to capture all characters including newlines in base64 data\n            const matches = img.match(/^data:([^;]+);base64,([\\s\\S]+)$/)\n\n            if (!matches) {\n              console.error('[IPC] Failed to parse image data URL. Format mismatch.')\n              return null\n            }\n\n            return {\n              inlineData: {\n                mimeType: matches[1],\n                data: matches[2]\n              }\n            }\n          })\n          .filter(Boolean)\n\n        // Add images first\n        msgParts = [...msgParts, ...imageParts]\n      }\n\n      // Add text part only if there is text\n      if (message && message.trim()) {\n        msgParts.push({ text: message })\n      } else if (msgParts.length === 0) {\n        // Fallback\n        msgParts.push({ text: '' })\n      }\n\n      // Retry logic for 429 Errors\n      let result\n      let retryCount = 0\n      const maxRetries = 3\n\n      while (true) {\n        try {\n          result = await chat.sendMessageStream(msgParts)\n          break\n        } catch (error: any) {\n          const isRateLimit =\n            error.message?.includes('429') ||\n            error.status === 429 ||\n            error.message?.includes('Too Many Requests') ||\n            error.message?.includes('Resource exhausted')\n\n          if (isRateLimit && retryCount < maxRetries) {\n            retryCount++\n            const delay = Math.pow(2, retryCount) * 1000 // 2s, 4s, 8s\n            console.log(\n              `[Gemini] Rate Limit (429). Retrying in ${delay}ms... (Attempt ${retryCount}/${maxRetries})`\n            )\n            await new Promise((resolve) => setTimeout(resolve, delay))\n          } else {\n            throw error\n          }\n        }\n      }\n\n      // Collect all chunks and check for function calls\n      let fullText = ''\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const allFunctionCalls: any[] = []\n\n      for await (const chunk of result.stream) {\n        try {\n          // chunk.text() throws if no text is present (e.g. only function call)\n          const text = chunk.text()\n          if (text) fullText += text\n        } catch (e) {\n          // Ignore missing text\n        }\n\n        const calls = chunk.functionCalls()\n        if (calls && calls.length > 0) {\n          allFunctionCalls.push(...calls)\n        }\n      }\n\n      // Execute function calls if any\n      const generatedImages: string[] = []\n\n      if (allFunctionCalls.length > 0) {\n        for (const call of allFunctionCalls) {\n          try {\n            console.log(`[IPC] Executing tool: ${call.name}`, call.args)\n\n            if (call.name === 'generate_image') {\n              // Use newest Imagen 4 model ID by default\n              const modelToUse = 'imagen-4.0-generate-001'\n              // eslint-disable-next-line @typescript-eslint/no-explicit-any\n              const res = await generateImageHelper(\n                apiKey,\n                modelToUse,\n                call.args.prompt as string,\n                call.args.aspectRatio as string\n              )\n              if (res.success && res.path) {\n                generatedImages.push(res.path)\n                // Do NOt append text, let the UI render the image card\n                // fullText += `\\n\\n> Generated Image: ${res.path}\\n`\n              }\n            } else if (call.name === 'generate_video') {\n              // Use default Veo model ID\n              const modelToUse = 'veo-3.1-generate-001'\n              // eslint-disable-next-line @typescript-eslint/no-explicit-any\n              const res = await generateVideoHelper(apiKey, modelToUse, call.args.prompt as string)\n              if (res.success && res.path) {\n                generatedImages.push(res.path)\n                // fullText += `\\n\\n> Generated Video: ${res.path}\\n`\n              }\n            }\n          } catch (err: any) {\n            console.error('[IPC] Tool Execution Failed:', err)\n            fullText += `\\n\\n(Tool execution failed: ${err.message})`\n          }\n        }\n      }\n\n      return {\n        success: true,\n        text: fullText,\n        images: generatedImages.length > 0 ? generatedImages : undefined\n      }\n    } catch (error: any) {\n      console.error('Gemini API Error:', error)\n      return { success: false, error: error.message || 'Unknown error' }\n    }\n  }\n)\n\nipcMain.handle('gemini:listModels', async (_event, { apiKey, showAll }) => {\n  try {\n    const response = await fetch(\n      `https://generativelanguage.googleapis.com/v1beta/models?key=${apiKey}`\n    )\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}: ${response.statusText}`)\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const data = (await response.json()) as any\n    const models = data.models || []\n\n    if (showAll) {\n      return { success: true, models }\n    }\n\n    // Filter out generation-only models (Imagen, Veo) to only show chat-capable models\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const filteredModels = models.filter((m: any) => {\n      const name = m.name.toLowerCase()\n      // Keep if it DOES NOT contain 'imagen' or 'veo'\n      return !name.includes('imagen') && !name.includes('veo')\n    })\n\n    return { success: true, models: filteredModels }\n  } catch (error: any) {\n    return { success: false, error: error.message }\n  }\n})\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\preload\\index.d.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 12,
        "column": 50,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 12,
        "endColumn": 53,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [321, 324], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [321, 324], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 17,
        "column": 18,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 17,
        "endColumn": 21,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [459, 462], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [459, 462], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 25,
        "column": 18,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 25,
        "endColumn": 21,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [714, 717], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [714, 717], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 52,
        "column": 22,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 52,
        "endColumn": 25,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1768, 1771], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1768, 1771], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 4,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { ElectronAPI } from '@electron-toolkit/preload'\n\ndeclare global {\n  interface Window {\n    electron: ElectronAPI\n    api: unknown\n    gemini: {\n      getUserAgent: () => Promise<string>\n      listModels: (params: {\n        apiKey: string\n        showAll?: boolean\n      }) => Promise<{ success: boolean; models?: any[]; error?: string }>\n      chat: (params: {\n        apiKey: string\n        modelName: string\n        message: string\n        history: any[]\n        systemInstruction?: string\n      }) => Promise<{ success: boolean; text?: string; error?: string }>\n      stream: (params: {\n        apiKey: string\n        modelName: string\n        message: string\n        images?: string[]\n        history: any[]\n        systemInstruction?: string\n      }) => Promise<{ success: boolean; text?: string; images?: string[]; error?: string }>\n      listImages: () => Promise<{ success: boolean; images: string[]; error?: string }>\n      saveImage: (params: {\n        base64Data: string\n      }) => Promise<{ success: boolean; path?: string; error?: string }>\n      deleteImage: (params: { filename: string }) => Promise<{ success: boolean; error?: string }>\n      deleteAllImages: () => Promise<{ success: boolean; error?: string }>\n      generateImage: (params: {\n        apiKey: string\n        modelId: string\n        prompt: string\n        aspectRatio?: string\n        personGeneration?: string\n      }) => Promise<{\n        success: boolean\n        path?: string\n        base64?: string\n        mimeType?: string\n        error?: string\n      }>\n      generateVideo: (params: {\n        apiKey: string\n        modelId: string\n        prompt: string\n      }) => Promise<{ success: boolean; path?: string; mimeType?: string; error?: string }>\n      [key: string]: any\n    }\n  }\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\preload\\index.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 6,
        "column": 18,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 6,
        "endColumn": 21,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [196, 199], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [196, 199], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 7,
        "column": 20,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 7,
        "endColumn": 23,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [266, 269], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [266, 269], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 8,
        "column": 24,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 8,
        "endColumn": 27,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [342, 345], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [342, 345], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 9,
        "column": 23,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 9,
        "endColumn": 26,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [421, 424], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [421, 424], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 11,
        "column": 25,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 11,
        "endColumn": 28,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [562, 565], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [562, 565], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 14,
        "column": 27,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 14,
        "endColumn": 30,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [782, 785], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [782, 785], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 15,
        "column": 27,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 15,
        "endColumn": 30,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [869, 872], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [869, 872], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 7,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { contextBridge, ipcRenderer } from 'electron'\nimport { electronAPI } from '@electron-toolkit/preload'\n\n// Custom APIs for renderer - Gemini IPC bridge\nconst geminiAPI = {\n  chat: (params: any) => ipcRenderer.invoke('gemini:chat', params),\n  stream: (params: any) => ipcRenderer.invoke('gemini:stream', params),\n  listModels: (params: any) => ipcRenderer.invoke('gemini:listModels', params),\n  saveImage: (params: any) => ipcRenderer.invoke('gemini:saveImage', params),\n  listImages: () => ipcRenderer.invoke('gemini:listImages'),\n  deleteImage: (params: any) => ipcRenderer.invoke('gemini:deleteImage', params),\n  deleteAllImages: () => ipcRenderer.invoke('gemini:deleteAllImages'),\n  getUserAgent: () => ipcRenderer.invoke('gemini:getUserAgent'),\n  generateImage: (params: any) => ipcRenderer.invoke('gemini:generate-image', params),\n  generateVideo: (params: any) => ipcRenderer.invoke('gemini:generate-video', params)\n}\n\n// Use `contextBridge` APIs to expose Electron APIs to\n// renderer only if context isolation is enabled, otherwise\n// just add to the DOM global.\nif (process.contextIsolated) {\n  try {\n    contextBridge.exposeInMainWorld('electron', electronAPI)\n    contextBridge.exposeInMainWorld('gemini', geminiAPI)\n  } catch (error) {\n    console.error(error)\n  }\n} else {\n  // @ts-ignore (define in dts)\n  window.electron = electronAPI\n  // @ts-ignore (define in dts)\n  window.gemini = geminiAPI\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\App.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'React' is defined but never used.",
        "line": 1,
        "column": 8,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 1,
        "endColumn": 13
      }
    ],
    "suppressedMessages": [],
    "errorCount": 1,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import React from 'react'\nimport { Layout } from './components/Layout'\nimport { ErrorBoundary } from './components/ErrorBoundary'\n\nfunction App(): JSX.Element {\n  return (\n    <ErrorBoundary>\n      <Layout />\n    </ErrorBoundary>\n  )\n}\n\nexport default App\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\components\\ChatArea.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 27,
        "column": 18,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 27,
        "endColumn": 21,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [551, 554], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [551, 554], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 35,
        "column": 18,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 35,
        "endColumn": 21,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [806, 809], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [806, 809], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 41,
        "column": 50,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 41,
        "endColumn": 53,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1066, 1069], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1066, 1069], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 84,
        "column": 8,
        "nodeType": "FunctionDeclaration",
        "messageId": "missingReturnType",
        "endLine": 84,
        "endColumn": 25
      },
      {
        "ruleId": "react-hooks/exhaustive-deps",
        "severity": 1,
        "message": "React Hook useEffect has a missing dependency: 'modelName'. Either include it or remove the dependency array. If 'setCurrentModel' needs the current value of 'modelName', you can also switch to useReducer instead of useState and read 'modelName' in the reducer.",
        "line": 177,
        "column": 6,
        "nodeType": "ArrayExpression",
        "endLine": 177,
        "endColumn": 20,
        "suggestions": [
          {
            "desc": "Update the dependencies array to be: [activeChatId, modelName]",
            "fix": { "range": [5440, 5454], "text": "[activeChatId, modelName]" }
          }
        ]
      },
      {
        "ruleId": "react-hooks/exhaustive-deps",
        "severity": 1,
        "message": "React Hook useEffect has a missing dependency: 'activeChatId'. Either include it or remove the dependency array.",
        "line": 184,
        "column": 6,
        "nodeType": "ArrayExpression",
        "endLine": 184,
        "endColumn": 17,
        "suggestions": [
          {
            "desc": "Update the dependencies array to be: [activeChatId, modelName]",
            "fix": { "range": [5654, 5665], "text": "[activeChatId, modelName]" }
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'history' is assigned a value but never used.",
        "line": 303,
        "column": 13,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 303,
        "endColumn": 20
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 304,
        "column": 22,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 304,
        "endColumn": 25,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [9443, 9446], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [9443, 9446], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": null,
        "message": "Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').",
        "line": 362,
        "column": 15,
        "severity": 1,
        "nodeType": null,
        "fix": { "range": [11303, 11365], "text": " " }
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 365,
        "column": 23,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 365,
        "endColumn": 26,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [11453, 11456], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [11453, 11456], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 380,
        "column": 25,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 380,
        "endColumn": 28,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [12143, 12146], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [12143, 12146], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 424,
        "column": 25,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 424,
        "endColumn": 28,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [14044, 14047], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [14044, 14047], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 467,
        "column": 5,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 467,
        "endColumn": 7
      },
      {
        "ruleId": "no-useless-catch",
        "severity": 2,
        "message": "Unnecessary try/catch wrapper.",
        "line": 468,
        "column": 5,
        "nodeType": "TryStatement",
        "messageId": "unnecessaryCatch",
        "endLine": 547,
        "endColumn": 6
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 545,
        "column": 17,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 545,
        "endColumn": 20,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [18358, 18361], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [18358, 18361], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 551,
        "column": 50,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 551,
        "endColumn": 52
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 552,
        "column": 18,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 552,
        "endColumn": 21,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [18500, 18503], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [18500, 18503], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 583,
        "column": 45,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 583,
        "endColumn": 47
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 639,
        "column": 40,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 639,
        "endColumn": 42
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 644,
        "column": 41,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 644,
        "endColumn": 43
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 651,
        "column": 38,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 651,
        "endColumn": 40
      }
    ],
    "suppressedMessages": [],
    "errorCount": 18,
    "fatalErrorCount": 0,
    "warningCount": 3,
    "fixableErrorCount": 0,
    "fixableWarningCount": 1,
    "source": "import { useState, useRef, useEffect } from 'react'\nimport {\n  Send,\n  Key,\n  Sparkles,\n  Mic,\n  Image as ImageIcon,\n  Plus,\n  X,\n  RotateCw,\n  Copy,\n  Share2,\n  Pencil\n} from 'lucide-react'\nimport { StorageService } from '../services/storage'\nimport { ChatMessage as Message } from '../types'\nimport { MODELS } from '../constants/models'\n\n// Declare the window.gemini API from preload\ndeclare global {\n  interface Window {\n    gemini: {\n      chat: (params: {\n        apiKey: string\n        modelName: string\n        message: string\n        history: any[]\n        systemInstruction?: string\n      }) => Promise<{ success: boolean; text?: string; error?: string }>\n      stream: (params: {\n        apiKey: string\n        modelName: string\n        message: string\n        images?: string[]\n        history: any[]\n        systemInstruction?: string\n      }) => Promise<{ success: boolean; text?: string; images?: string[]; error?: string }>\n      listModels: (params: {\n        apiKey: string\n        showAll?: boolean\n      }) => Promise<{ success: boolean; models?: any[]; error?: string }>\n      saveImage: (params: {\n        base64Data: string\n      }) => Promise<{ success: boolean; path?: string; error?: string }>\n      listImages: () => Promise<{ success: boolean; images?: string[]; error?: string }>\n      deleteImage: (params: { filename: string }) => Promise<{ success: boolean; error?: string }>\n      deleteAllImages: () => Promise<{ success: boolean; error?: string }>\n      getUserAgent: () => Promise<string>\n      generateImage: (params: {\n        apiKey: string\n        modelId: string\n        prompt: string\n        aspectRatio?: string\n        personGeneration?: string\n      }) => Promise<{\n        success: boolean\n        path?: string\n        base64?: string\n        mimeType?: string\n        error?: string\n      }>\n      generateVideo: (params: {\n        apiKey: string\n        modelId: string\n        prompt: string\n      }) => Promise<{ success: boolean; path?: string; mimeType?: string; error?: string }>\n    }\n  }\n}\n\ninterface ChatAreaProps {\n  activeChatId: string | null\n  onUpdateChat: (id: string, messages: Message[], title?: string, modelId?: string) => void\n  onCreateChat: (initialMessage: string, modelId?: string) => Promise<string>\n  apiKey: string\n  modelName: string // Default model from settings\n  systemInstruction?: string\n  onOpenSettings: () => void\n  highlightedImage?: string\n  userName?: string\n  globalInstructions?: string\n}\n\nexport function ChatArea({\n  activeChatId,\n  onUpdateChat,\n  onCreateChat,\n  apiKey,\n  modelName,\n  systemInstruction,\n  onOpenSettings,\n  highlightedImage,\n  userName,\n  globalInstructions\n}: ChatAreaProps) {\n  const [messages, setMessages] = useState<Message[]>([])\n  const [input, setInput] = useState('')\n  const [loading, setLoading] = useState(false)\n  const [currentModel, setCurrentModel] = useState(modelName)\n  const [attachments, setAttachments] = useState<string[]>([])\n  const [viewedImage, setViewedImage] = useState<string | null>(null)\n  const messagesEndRef = useRef<HTMLDivElement>(null)\n  const fileInputRef = useRef<HTMLInputElement>(null)\n  const containerRef = useRef<HTMLDivElement>(null)\n\n  // Track if this is the initial mount\n  const isInitialMount = useRef(true)\n\n  // Effect for deep linking/highlighting\n  useEffect(() => {\n    if (highlightedImage && messages.length > 0) {\n      // Wait a tick for rendering\n      setTimeout(() => {\n        // Find all img tags\n        const imgs = containerRef.current?.querySelectorAll('img')\n        if (!imgs) return\n\n        let targetImg: HTMLImageElement | null = null\n\n        // Try to find Exact match first\n        for (let i = 0; i < imgs.length; i++) {\n          if (imgs[i].src === highlightedImage) {\n            targetImg = imgs[i]\n            break\n          }\n        }\n\n        // Fallback: Ends with filename (since src might be file:// or gemini-media://)\n        if (!targetImg) {\n          const targetFilename = highlightedImage.split('/').pop()\n          if (targetFilename) {\n            for (let i = 0; i < imgs.length; i++) {\n              if (imgs[i].src.endsWith(targetFilename)) {\n                targetImg = imgs[i]\n                break\n              }\n            }\n          }\n        }\n\n        if (targetImg) {\n          targetImg.scrollIntoView({ behavior: 'smooth', block: 'center' })\n          // Add temporary highlight animation\n          targetImg.style.transition = 'box-shadow 0.3s ease'\n          targetImg.style.boxShadow = '0 0 0 4px #f4b400'\n          setTimeout(() => {\n            if (targetImg) targetImg.style.boxShadow = ''\n          }, 2000)\n        }\n      }, 100)\n    } else if (!highlightedImage) {\n      scrollToBottom()\n    }\n  }, [messages, highlightedImage])\n\n  useEffect(() => {\n    if (activeChatId) {\n      const chats = StorageService.getChats()\n      const currentChat = chats.find((c) => c.id === activeChatId)\n      if (currentChat) {\n        setMessages(currentChat.messages)\n        // Use chat's model if set, otherwise keep current selection\n        if (currentChat.modelId) {\n          setCurrentModel(currentChat.modelId)\n        }\n      } else {\n        setMessages([])\n      }\n    } else {\n      setMessages([])\n      // Only set default model on initial mount, not when user clears chat\n      if (isInitialMount.current) {\n        setCurrentModel(modelName)\n        isInitialMount.current = false\n      }\n    }\n  }, [activeChatId])\n\n  // Update default model if settings change (but only if no chat-specific model)\n  useEffect(() => {\n    if (!activeChatId && isInitialMount.current) {\n      setCurrentModel(modelName)\n    }\n  }, [modelName])\n\n  const scrollToBottom = (behavior: ScrollBehavior = 'smooth'): void => {\n    messagesEndRef.current?.scrollIntoView({ behavior })\n  }\n\n  // ...\n\n  useEffect(() => {\n    // Only auto-scroll to bottom if NOT highlighting an image\n    if (!highlightedImage) {\n      // Use 'auto' (instant) scrolling when loading/streaming to prevent stutter and missed updates\n      scrollToBottom(loading ? 'auto' : 'smooth')\n    }\n  }, [messages, loading, highlightedImage])\n\n  const handleModelChange = (newModelId: string): void => {\n    setCurrentModel(newModelId)\n    // If there's an active chat, persist the model choice\n    if (activeChatId) {\n      onUpdateChat(activeChatId, messages, undefined, newModelId)\n    }\n  }\n\n  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>): void => {\n    if (e.target.files && e.target.files.length > 0) {\n      const files = Array.from(e.target.files)\n      files.forEach((file) => {\n        const reader = new FileReader()\n        reader.onloadend = () => {\n          if (typeof reader.result === 'string') {\n            setAttachments((prev) => [...prev, reader.result as string])\n          }\n        }\n        reader.readAsDataURL(file)\n      })\n    }\n    // Reset input so same file can be selected again\n    if (fileInputRef.current) fileInputRef.current.value = ''\n  }\n\n  const removeAttachment = (index: number): void => {\n    setAttachments((prev) => prev.filter((_, i) => i !== index))\n  }\n\n  const handleSend = async (): Promise<void> => {\n    if (!input.trim() && attachments.length === 0) return\n\n    if (!apiKey) {\n      onOpenSettings()\n      return\n    }\n\n    const userMsg = input.trim()\n    const currentAttachments = [...attachments]\n\n    setInput('')\n    setAttachments([])\n\n    let currentChatId = activeChatId\n    let currentMessages = messages\n\n    // If no active chat, create one\n    if (!currentChatId) {\n      currentChatId = await onCreateChat(userMsg)\n      currentMessages = []\n    }\n\n    // Save images to disk first\n    let savedImagePaths: string[] = []\n    if (currentAttachments.length > 0) {\n      try {\n        const savePromises = currentAttachments.map((base64) =>\n          window.gemini.saveImage({ base64Data: base64 })\n        )\n        const results = await Promise.all(savePromises)\n        savedImagePaths = results\n          .map((r) => (r.success ? r.path : null))\n          .filter(Boolean) as string[]\n      } catch (err) {\n        console.error('Failed to save images to disk', err)\n        // Fallback to base64 if save fails (or user can live with it)\n        // But we prefer paths.\n      }\n    }\n\n    // Use PATHS for display history (to save space), but BASE64 for API call (immediate)\n    // Wait, if we use paths for display, we hope the <img src> works with file://\n    // Ideally we use base64 for IMMEDIATE display (optimistic),\n    // but commit paths to storage.\n\n    // We'll update the optimistic message to use paths if available, or base64 if not?\n    // Actually, let's use the Saved Paths for the message object we add to state.\n    // It's cleaner. If save fails, we use base64.\n    const displayImages =\n      savedImagePaths.length > 0\n        ? savedImagePaths\n        : currentAttachments.length > 0\n          ? currentAttachments\n          : undefined\n\n    const newMessages: Message[] = [\n      ...currentMessages,\n      {\n        role: 'user',\n        content: userMsg,\n        images: displayImages\n      }\n    ]\n    setMessages(newMessages)\n    if (currentChatId) onUpdateChat(currentChatId, newMessages)\n\n    setLoading(true)\n\n    // Add placeholder for response\n    setMessages((prev) => [...prev, { role: 'model', content: '...' }])\n\n    try {\n      // Build history in API format\n      const history = currentMessages.map((m) => {\n        const parts: any[] = []\n\n        // Add images first\n        if (m.role !== 'model' && m.images && m.images.length > 0) {\n          m.images.forEach((img) => {\n            if (img.startsWith('data:')) {\n              const matches = img.match(/^data:(.+);base64,([\\s\\S]+)$/)\n              if (matches) {\n                parts.push({\n                  inlineData: {\n                    mimeType: matches[1],\n                    data: matches[2]\n                  }\n                })\n              }\n            } else if (img.startsWith('gemini-media://')) {\n              // Pass the protocol URL to the main process to handle\n              parts.push({\n                internalUrl: img\n              })\n            }\n          })\n        }\n\n        // Add text if present\n        if (m.content && m.content.trim()) {\n          parts.push({ text: m.content })\n        } else if (parts.length === 0) {\n          // Fallback for empty message (should not happen)\n          parts.push({ text: '' })\n        }\n\n        return {\n          role: m.role,\n          parts: parts\n        }\n      })\n\n      if (currentMessages.length === 0 && currentChatId) {\n        onUpdateChat(currentChatId, newMessages, userMsg.slice(0, 30))\n      }\n\n      // Combine global instructions with gem instructions\n      const combinedSystemInstruction = [globalInstructions, systemInstruction]\n        .filter(Boolean)\n        .join('\\n\\n')\n\n      // Handle Slash Commands\n      if (userMsg.trim().startsWith('/')) {\n        const parts = userMsg.trim().split(/\\s+/)\n        const cmd = parts[0].toLowerCase()\n\n        // /list models\n        if (cmd === '/list' && parts[1]?.toLowerCase() === 'models') {\n          try {\n            const res = await window.gemini.listModels({ apiKey, showAll: true })\n            let responseText = ''\n            if (res.success && res.models) {\n              // eslint-disable-next-line @typescript-eslint/no-explicit-any\n              const modelList = res.models\n                .map(\n                  (m: any) =>\n                    `- **${m.displayName || m.name}** (\\`${m.name.replace('models/', '')}\\`)`\n                )\n                .join('\\n')\n              responseText = `### Available Models (All)\\n\\nYou can use these IDs with \\`/generate [model] [prompt]\\`:\\n\\n${modelList}`\n            } else {\n              responseText = `Error listing models: ${res.error || 'Unknown error'}`\n            }\n\n            const finalMessages = [\n              ...newMessages,\n              { role: 'model', content: responseText }\n            ] as Message[]\n            setMessages(finalMessages)\n            if (currentChatId) onUpdateChat(currentChatId, finalMessages)\n          } catch (err: any) {\n            const errMsg = `Error: ${err.message}`\n            const finalMessages = [...newMessages, { role: 'model', content: errMsg }] as Message[]\n            setMessages(finalMessages)\n            if (currentChatId) onUpdateChat(currentChatId, finalMessages)\n          }\n          setLoading(false)\n          return\n        }\n\n        // /generate [model] [prompt]\n        if (cmd === '/generate') {\n          if (parts.length < 3) {\n            const helpMsg = `**Usage:** \\`/generate [model_id] [prompt]\\`\\nExample: \\`/generate imagen-4.0-generate-001 A futuristic city\\``\n            const finalMessages = [...newMessages, { role: 'model', content: helpMsg }] as Message[]\n            setMessages(finalMessages)\n            if (currentChatId) onUpdateChat(currentChatId, finalMessages)\n            setLoading(false)\n            return\n          }\n\n          const modelId = parts[1]\n          const prompt = parts.slice(2).join(' ')\n\n          try {\n            const res = await window.gemini.generateImage({ apiKey, modelId, prompt })\n            if (res.success && res.path) {\n              const successMsg: Message = {\n                role: 'model',\n                content: `Generated using **${modelId}**:\\n\"${prompt}\"`,\n                images: [res.path]\n              }\n              const finalMessages = [...newMessages, successMsg] as Message[]\n              setMessages(finalMessages)\n              if (currentChatId) onUpdateChat(currentChatId, finalMessages)\n            } else {\n              const errorMsg = `Generation failed: ${res.error || 'Unknown error'}`\n              const finalMessages = [\n                ...newMessages,\n                { role: 'model', content: errorMsg }\n              ] as Message[]\n              setMessages(finalMessages)\n              if (currentChatId) onUpdateChat(currentChatId, finalMessages)\n            }\n          } catch (err: any) {\n            const errorMsg = `Generation error: ${err.message}`\n            const finalMessages = [\n              ...newMessages,\n              { role: 'model', content: errorMsg }\n            ] as Message[]\n            setMessages(finalMessages)\n            if (currentChatId) onUpdateChat(currentChatId, finalMessages)\n          }\n          setLoading(false)\n          return\n        }\n      }\n\n      // Standard Generation\n      await generateResponse(newMessages, currentChatId, combinedSystemInstruction)\n    } catch (error) {\n      console.error(error)\n      setMessages((prev) => {\n        const newArr = [...prev]\n        const errorMessage = error instanceof Error ? error.message : 'Unknown error'\n        // Check if we added a placeholder\n        if (\n          newArr.length > 0 &&\n          newArr[newArr.length - 1].role === 'model' &&\n          newArr[newArr.length - 1].content === '...'\n        ) {\n          newArr[newArr.length - 1].content =\n            `Error: ${errorMessage}\\n\\nPlease check your API Key in Settings.`\n        } else {\n          newArr.push({ role: 'model', content: `Error: ${errorMessage}` })\n        }\n        return newArr\n      })\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const generateResponse = async (\n    historyMessages: Message[],\n    chatId: string,\n    instructions?: string\n  ) => {\n    try {\n      // Build history in API format\n\n      // The last message is the User's new input\n      const lastMsg = historyMessages[historyMessages.length - 1]\n      if (lastMsg.role !== 'user') {\n        console.error('Last message is not user!')\n        return\n      }\n\n      // We need to exclude the last message from history passed to startChat\n      const historyForChat = historyMessages.slice(0, -1).map(convertMessageToApiFormat)\n\n      const result = await window.gemini.stream({\n        apiKey,\n        modelName: currentModel,\n        message: lastMsg.content,\n        images: lastMsg.images?.filter(\n          (img) => img.startsWith('data:') || img.startsWith('gemini-media://')\n        ), // Only pass data/protocol URIs\n        history: historyForChat,\n        systemInstruction: instructions\n      })\n\n      if (result.success) {\n        setMessages((prev) => {\n          const newArr = [...prev]\n          const lastMsgPlaceholder = newArr[newArr.length - 1]\n          // We expect a placeholder '...' to be there if we called this from handleSend\n          // But if this is a retry, we might need to handle state differently.\n\n          // Actually, let's keep it simple:\n          // When `generateResponse` is called, we assume the state ALREADY has the '...' placeholder?\n          // OR `generateResponse` interacts with state?\n\n          // `handleSend` added the placeholder.\n          // Let's assume the placeholder is there.\n          if (lastMsgPlaceholder.role === 'model' && lastMsgPlaceholder.content === '...') {\n            lastMsgPlaceholder.content = result.text || ''\n            lastMsgPlaceholder.images = result.images\n          } else {\n            // Should not happen if flow is correct, but let's append if missing\n            newArr.push({\n              role: 'model',\n              content: result.text || '',\n              images: result.images\n            })\n          }\n          return newArr\n        })\n\n        // We need to reconstruct the final messages array for `onUpdateChat`\n        // Since `setMessages` is async, we can't read it back immediately.\n        // We'll approximate:\n        const updatedMessages = [\n          ...historyMessages,\n          {\n            role: 'model',\n            content: result.text || '',\n            images: result.images\n          }\n        ] as Message[]\n\n        if (chatId) onUpdateChat(chatId, updatedMessages)\n      } else {\n        setMessages((prev) => {\n          const newArr = [...prev]\n          const lastMsgPlaceholder = newArr[newArr.length - 1]\n          const errorText = `Error: ${result.error}\\n\\nTry a different model or check your API key.`\n          if (lastMsgPlaceholder.role === 'model' && lastMsgPlaceholder.content === '...') {\n            lastMsgPlaceholder.content = errorText\n          } else {\n            newArr.push({ role: 'model', content: errorText })\n          }\n          return newArr\n        })\n      }\n    } catch (e: any) {\n      throw e\n    }\n  }\n\n  // Helper to format messages for API\n  const convertMessageToApiFormat = (m: Message) => {\n    const parts: any[] = []\n    if (m.role !== 'model' && m.images && m.images.length > 0) {\n      m.images.forEach((img) => {\n        if (img.startsWith('data:')) {\n          const matches = img.match(/^data:(.+);base64,([\\s\\S]+)$/)\n          if (matches) {\n            parts.push({\n              inlineData: {\n                mimeType: matches[1],\n                data: matches[2]\n              }\n            })\n          }\n        } else if (img.startsWith('gemini-media://')) {\n          parts.push({\n            internalUrl: img\n          })\n        }\n      })\n    }\n    if (m.content && m.content.trim()) {\n      parts.push({ text: m.content })\n    } else if (parts.length === 0) {\n      parts.push({ text: '' })\n    }\n    return {\n      role: m.role,\n      parts: parts\n    }\n  }\n\n  const handleRetry = async (index: number) => {\n    if (loading) return\n\n    // Check if apiKey is present\n    if (!apiKey) {\n      onOpenSettings()\n      return\n    }\n\n    const targetMsg = messages[index]\n\n    let historyToKeep: Message[] = []\n\n    if (targetMsg.role === 'model') {\n      // Retro-compatibility or if we decide to keep it on model too\n      // History = messages[0...index] (Excludes this model message)\n      // Wait, slice(0, index) gives 0 to index-1.\n      historyToKeep = messages.slice(0, index)\n\n      // Validate preceding is user\n      if (historyToKeep.length === 0 || historyToKeep[historyToKeep.length - 1].role !== 'user') {\n        console.error('Cannot retry: Preceding message is not user')\n        return\n      }\n    } else if (targetMsg.role === 'user') {\n      // If retrying a USER message, we want to KEEP that message and regenerate response.\n      // History = messages[0...index+1] (Includes this user message)\n      historyToKeep = messages.slice(0, index + 1)\n    } else {\n      return\n    }\n\n    // Set state to truncated history + Placeholder\n    setMessages([...historyToKeep, { role: 'model', content: '...' }])\n    setLoading(true)\n\n    // Combined instructions\n    const combinedSystemInstruction = [globalInstructions, systemInstruction]\n      .filter(Boolean)\n      .join('\\n\\n')\n\n    try {\n      await generateResponse(historyToKeep, activeChatId || '', combinedSystemInstruction)\n    } catch (error) {\n      console.error('Retry failed', error)\n      setMessages((prev) => {\n        const newArr = [...prev]\n        const errorMessage = error instanceof Error ? error.message : 'Unknown error'\n        newArr[newArr.length - 1].content = `Error: ${errorMessage}`\n        return newArr\n      })\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleCopy = (content: string) => {\n    navigator.clipboard.writeText(content)\n    // Optionally show toast? For now just copy.\n  }\n\n  const handleShare = (content: string) => {\n    // Simple mailto\n    const subject = 'Shared from Gemini App'\n    const body = encodeURIComponent(content)\n    window.open(`mailto:?subject=${subject}&body=${body}`)\n  }\n\n  const handleEdit = (index: number) => {\n    const targetMsg = messages[index]\n\n    if (targetMsg.role === 'model') {\n      // Edit preceding user message\n      const previousUserMsgIndex = index - 1\n      if (previousUserMsgIndex < 0 || messages[previousUserMsgIndex].role !== 'user') {\n        return\n      }\n      // Recursive call for the user message\n      handleEdit(previousUserMsgIndex)\n      return\n    }\n\n    if (targetMsg.role === 'user') {\n      // Populate input\n      setInput(targetMsg.content)\n\n      // Restore images if possible (only data URIs, not file paths easily)\n      // For now, we only restore text.\n\n      // Revert history to BEFORE this user message\n      // messages[0...index] (Exclusive)\n      const historyToKeep = messages.slice(0, index)\n      setMessages(historyToKeep)\n      if (activeChatId) onUpdateChat(activeChatId, historyToKeep)\n\n      // Focus input\n      setTimeout(() => {\n        const textarea = document.querySelector('textarea')\n        textarea?.focus()\n      }, 100)\n    }\n  }\n\n  if (!apiKey && !activeChatId) {\n    return (\n      <div className=\"flex-1 flex flex-col items-center justify-center p-8 text-center bg-[#131314] text-[#e3e3e3]\">\n        <Key className=\"w-12 h-12 text-[#8ab4f8] mb-4\" />\n        <h2 className=\"text-2xl font-GoogleSans mb-2\">Setup API Key</h2>\n        <p className=\"text-gray-400 mb-6 max-w-md\">\n          To use the API mode, you need to add a Google Gemini API Key in Settings.\n        </p>\n        <button\n          onClick={onOpenSettings}\n          className=\"bg-[#8ab4f8] hover:bg-[#aecbfa] text-[#041e49] px-6 py-2.5 rounded-full font-medium transition-colors\"\n        >\n          Open Settings\n        </button>\n      </div>\n    )\n  }\n\n  const isZeroState = !activeChatId || messages.length === 0\n\n  return (\n    <div className=\"flex-1 flex flex-col h-full bg-[#131314] text-[#e3e3e3] relative font-sans\">\n      <div\n        ref={containerRef}\n        className={`flex-1 overflow-y-auto px-4 md:px-[15%] pt-8 pb-4 flex flex-col ${isZeroState ? 'justify-center items-center' : 'gap-10'}`}\n      >\n        {isZeroState ? (\n          <div className=\"flex flex-col items-start w-full max-w-3xl mb-10 pl-2\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              {systemInstruction ? (\n                <span className=\"bg-[#f4b400]/20 text-[#f4b400] text-xs px-2 py-0.5 rounded flex items-center gap-1\">\n                  <Sparkles size={10} /> Custom Gem Active\n                </span>\n              ) : (\n                <Sparkles className=\"text-[#c48df6]\" size={36} />\n              )}\n            </div>\n            <h1 className=\"text-5xl font-medium bg-gradient-to-r from-[#4285f4] via-[#ec407a] to-[#f4b400] bg-clip-text text-transparent pb-2\">\n              Hello, {userName || 'User'}\n            </h1>\n            <p className=\"text-[#8e8e8e] text-2xl font-light\">How can I help you today?</p>\n          </div>\n        ) : (\n          <>\n            {messages.map((msg, idx) => (\n              <div\n                key={idx}\n                className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'} w-full group/message`}\n              >\n                <div\n                  className={`max-w-[85%] rounded-[20px] px-6 py-4 text-[15px] leading-relaxed relative ${\n                    msg.role === 'user'\n                      ? 'bg-[#2c2d2e] text-[#e3e3e3]'\n                      : 'bg-transparent text-[#e3e3e3]'\n                  }`}\n                >\n                  {msg.role === 'model' && <Sparkles size={16} className=\"text-[#c48df6] mb-2\" />}\n                  {msg.content === '...' && idx === messages.length - 1 ? (\n                    <div className=\"flex space-x-1 h-6 items-center px-1\">\n                      <div className=\"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce [animation-delay:-0.3s]\"></div>\n                      <div className=\"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce [animation-delay:-0.15s]\"></div>\n                      <div className=\"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce\"></div>\n                    </div>\n                  ) : (\n                    <>\n                      {msg.images && msg.images.length > 0 && (\n                        <div className=\"flex flex-wrap gap-2 mb-3\">\n                          {msg.images.map((img, i) => {\n                            const lowerImg = img.toLowerCase()\n                            const isPdf =\n                              img.startsWith('data:application/pdf') || lowerImg.endsWith('.pdf')\n                            const isVideo =\n                              img.startsWith('data:video/') ||\n                              /\\.(mp4|webm|mov|avi)$/i.test(lowerImg)\n\n                            if (isVideo) {\n                              return (\n                                <video\n                                  key={i}\n                                  src={img}\n                                  controls\n                                  className=\"w-full max-w-[300px] h-auto rounded-lg border border-gray-700/50 cursor-pointer\"\n                                  onClick={() => setViewedImage(img)}\n                                />\n                              )\n                            }\n\n                            const isDataImage = img.startsWith('data:image/')\n                            const isProtocolImage = img.startsWith('gemini-media://')\n                            const isFileImage = /\\.(jpg|jpeg|png|webp|gif|bmp)$/i.test(img)\n\n                            // Determine if it should be rendered as an image\n                            const shouldRenderAsImage =\n                              isDataImage || isFileImage || isProtocolImage\n\n                            // Render PDF/Docs/Unknown as file card\n                            if (isPdf || !shouldRenderAsImage) {\n                              return (\n                                <div\n                                  key={i}\n                                  className=\"flex items-center gap-2 bg-[#1e1f20] border border-gray-700 rounded-lg px-3 py-2 text-sm text-[#8ab4f8]\"\n                                >\n                                  <div className=\"bg-red-500/20 p-1.5 rounded\">\n                                    <svg\n                                      className=\"w-4 h-4 text-red-400\"\n                                      fill=\"none\"\n                                      viewBox=\"0 0 24 24\"\n                                      stroke=\"currentColor\"\n                                    >\n                                      <path\n                                        strokeLinecap=\"round\"\n                                        strokeLinejoin=\"round\"\n                                        strokeWidth={2}\n                                        d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\n                                      />\n                                    </svg>\n                                  </div>\n                                  <span className=\"truncate max-w-[150px]\">\n                                    {img.startsWith('data:')\n                                      ? `Attachment ${i + 1}`\n                                      : img.split(/[/\\\\]/).pop()}\n                                  </span>\n                                </div>\n                              )\n                            }\n\n                            // Render Image\n                            return (\n                              <img\n                                key={i}\n                                src={img}\n                                alt=\"attachment\"\n                                className=\"w-full max-w-[300px] h-auto rounded-lg border border-gray-700/50 object-contain hover:scale-105 transition-transform cursor-pointer\"\n                                onClick={() => setViewedImage(img)}\n                                onError={(e) => {\n                                  // If image fails to load, we could replace with card, but for now just hide\n                                  e.currentTarget.style.display = 'none'\n                                }}\n                              />\n                            )\n                          })}\n                        </div>\n                      )}\n                      <div className=\"whitespace-pre-wrap\">{msg.content}</div>\n\n                      {/* Model Message Toolbar (Copy, Share) */}\n                      {msg.role === 'model' && (\n                        <div className=\"absolute -bottom-10 left-0 flex items-center gap-1 opacity-0 group-hover/message:opacity-100 transition-opacity duration-200 py-2\">\n                          <button\n                            onClick={() => handleCopy(msg.content)}\n                            className=\"p-1.5 rounded hover:bg-[#3c4043] text-gray-400 hover:text-white transition-colors\"\n                            title=\"Copy\"\n                          >\n                            <Copy size={14} />\n                          </button>\n                          <button\n                            onClick={() => handleShare(msg.content)}\n                            className=\"p-1.5 rounded hover:bg-[#3c4043] text-gray-400 hover:text-white transition-colors\"\n                            title=\"Share\"\n                          >\n                            <Share2 size={14} />\n                          </button>\n                        </div>\n                      )}\n\n                      {/* User Message Toolbar (Retry, Edit) */}\n                      {msg.role === 'user' && !loading && (\n                        <div className=\"absolute -bottom-10 right-0 flex items-center gap-1 opacity-0 group-hover/message:opacity-100 transition-opacity duration-200 py-2\">\n                          <button\n                            onClick={() => handleEdit(idx)}\n                            className=\"p-1.5 rounded hover:bg-[#3c4043] text-gray-400 hover:text-white transition-colors\"\n                            title=\"Edit\"\n                          >\n                            <Pencil size={14} />\n                          </button>\n                          <button\n                            onClick={() => handleRetry(idx)}\n                            className=\"p-1.5 rounded hover:bg-[#3c4043] text-gray-400 hover:text-white transition-colors\"\n                            title=\"Retry (Resend)\"\n                          >\n                            <RotateCw size={14} />\n                          </button>\n                        </div>\n                      )}\n                    </>\n                  )}\n                </div>\n              </div>\n            ))}\n          </>\n        )}\n        <div ref={messagesEndRef} />\n      </div>\n\n      <div className={`w-full max-w-3xl mx-auto px-4 ${isZeroState ? 'mb-20' : 'mb-6'}`}>\n        <div className=\"relative bg-[#1e1f20] rounded-[28px] transition-all hover:bg-[#2c2d2e] group\">\n          <div className=\"flex flex-col\">\n            {attachments.length > 0 && (\n              <div className=\"flex gap-2 px-6 pt-4 overflow-x-auto\">\n                {attachments.map((img, idx) => (\n                  <div key={idx} className=\"relative group shrink-0\">\n                    <img\n                      src={img}\n                      alt=\"preview\"\n                      className=\"w-16 h-16 object-cover rounded-lg border border-gray-700\"\n                    />\n                    <button\n                      onClick={() => removeAttachment(idx)}\n                      className=\"absolute -top-1 -right-1 bg-gray-800 rounded-full p-0.5 text-gray-400 hover:text-white border border-gray-600 shadow-sm\"\n                    >\n                      <X size={12} />\n                    </button>\n                  </div>\n                ))}\n              </div>\n            )}\n            <textarea\n              className=\"w-full bg-transparent text-[#e3e3e3] placeholder-[#8e8e8e] px-6 py-4 rounded-[28px] focus:outline-none resize-none min-h-[60px] max-h-[200px]\"\n              placeholder={attachments.length > 0 ? 'Ask about this image...' : 'Ask Gemini'}\n              rows={1}\n              value={input}\n              onChange={(e) => setInput(e.target.value)}\n              onKeyDown={(e) => {\n                if (e.key === 'Enter' && !e.shiftKey) {\n                  e.preventDefault()\n                  handleSend()\n                }\n              }}\n              disabled={loading}\n              style={{ scrollbarWidth: 'none' }}\n            />\n\n            <div className=\"flex items-center justify-between px-4 pb-3\">\n              <div className=\"flex items-center gap-2\">\n                <input\n                  type=\"file\"\n                  ref={fileInputRef}\n                  onChange={handleFileSelect}\n                  className=\"hidden\"\n                  accept=\"image/png, image/jpeg, image/webp, image/heic, application/pdf\"\n                  multiple\n                />\n                <button\n                  onClick={() => fileInputRef.current?.click()}\n                  className=\"p-2 rounded-full text-[#e3e3e3] hover:bg-[#3c4043] transition-colors\"\n                  title=\"Add files\"\n                >\n                  <Plus size={20} />\n                </button>\n                <button\n                  onClick={() => fileInputRef.current?.click()}\n                  className=\"p-2 rounded-full text-[#e3e3e3] hover:bg-[#3c4043] transition-colors\"\n                  title=\"Add images\"\n                >\n                  <ImageIcon size={20} />\n                </button>\n              </div>\n\n              <div className=\"flex items-center gap-2\">\n                {input.trim() || attachments.length > 0 ? (\n                  <button\n                    onClick={handleSend}\n                    disabled={loading}\n                    className=\"p-2 bg-[#e3e3e3] text-[#131314] rounded-full hover:bg-white transition-opacity disabled:opacity-50\"\n                  >\n                    <Send size={18} className=\"translate-x-0.5\" />\n                  </button>\n                ) : (\n                  <button className=\"p-2 rounded-full text-[#e3e3e3] hover:bg-[#3c4043] transition-colors\">\n                    <Mic size={20} />\n                  </button>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"flex justify-center mt-2\">\n          <div className=\"relative inline-flex items-center gap-2 text-[10px] bg-[#1e1f20] px-3 py-1.5 rounded-full border border-gray-800 hover:border-gray-600 transition-colors\">\n            <select\n              value={currentModel}\n              onChange={(e) => handleModelChange(e.target.value)}\n              className=\"bg-transparent text-gray-400 appearance-none cursor-pointer focus:outline-none pr-4\"\n              style={{ fontSize: '10px' }}\n            >\n              {MODELS.map((m) => (\n                <option key={m.id} value={m.id} className=\"bg-[#1e1f20]\">\n                  {m.name}\n                </option>\n              ))}\n            </select>\n            <svg\n              className=\"w-3 h-3 text-gray-500 absolute right-3 pointer-events-none\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M19 9l-7 7-7-7\"\n              />\n            </svg>\n          </div>\n        </div>\n\n        <p className=\"text-center text-[11px] text-[#8e8e8e] mt-3\">\n          Gemini can make mistakes, so double-check it.\n        </p>\n      </div>\n\n      {/* Lightbox Modal */}\n      {viewedImage && (\n        <div\n          className=\"fixed inset-0 z-50 bg-black/90 flex items-center justify-center p-4 backdrop-blur-sm\"\n          onClick={() => setViewedImage(null)}\n        >\n          <button\n            className=\"absolute top-4 right-4 text-white hover:text-gray-300 bg-gray-900/50 rounded-full p-2 transition-colors\"\n            onClick={() => setViewedImage(null)}\n          >\n            <X size={24} />\n          </button>\n\n          {viewedImage.startsWith('data:video/') ||\n          /\\.(mp4|webm|mov|avi)$/i.test(viewedImage.toLowerCase()) ? (\n            <video\n              src={viewedImage}\n              controls\n              autoPlay\n              className=\"max-w-full max-h-[90vh] rounded-lg shadow-2xl bg-black\"\n              onClick={(e) => e.stopPropagation()}\n            />\n          ) : (\n            <img\n              src={viewedImage}\n              alt=\"Full size\"\n              className=\"max-w-full max-h-[90vh] rounded-lg shadow-2xl object-contain bg-black\"\n              onClick={(e) => e.stopPropagation()}\n            />\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\components\\ErrorBoundary.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'React' is defined but never used.",
        "line": 1,
        "column": 8,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 1,
        "endColumn": 13
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 22,
        "column": 3,
        "nodeType": "FunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 22,
        "endColumn": 27
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 26,
        "column": 3,
        "nodeType": "FunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 26,
        "endColumn": 16
      }
    ],
    "suppressedMessages": [],
    "errorCount": 3,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import React, { Component, ErrorInfo, ReactNode } from 'react'\n\ninterface Props {\n  children?: ReactNode\n}\n\ninterface State {\n  hasError: boolean\n  error: Error | null\n}\n\nexport class ErrorBoundary extends Component<Props, State> {\n  public state: State = {\n    hasError: false,\n    error: null\n  }\n\n  public static getDerivedStateFromError(error: Error): State {\n    return { hasError: true, error }\n  }\n\n  public componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    console.error('Uncaught error:', error, errorInfo)\n  }\n\n  public render() {\n    if (this.state.hasError) {\n      return (\n        <div style={{ padding: '20px', color: 'red', backgroundColor: '#fff' }}>\n          <h1>Something went wrong.</h1>\n          <pre>{this.state.error?.toString()}</pre>\n          <pre>{this.state.error?.stack}</pre>\n        </div>\n      )\n    }\n\n    return this.props.children\n  }\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\components\\GalleryModal.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 10,
        "column": 8,
        "nodeType": "FunctionDeclaration",
        "messageId": "missingReturnType",
        "endLine": 10,
        "endColumn": 29
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 20,
        "column": 31,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 20,
        "endColumn": 33
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 34,
        "column": 40,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 34,
        "endColumn": 42
      }
    ],
    "suppressedMessages": [],
    "errorCount": 3,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { X } from 'lucide-react'\nimport { useEffect, useState } from 'react'\n\ninterface GalleryModalProps {\n  isOpen: boolean\n  onClose: () => void\n  onGoToImage?: (path: string) => void\n}\n\nexport function GalleryModal({ isOpen, onClose, onGoToImage }: GalleryModalProps) {\n  const [images, setImages] = useState<string[]>([])\n  const [loading, setLoading] = useState(false)\n\n  useEffect(() => {\n    if (isOpen) {\n      loadImages()\n    }\n  }, [isOpen])\n\n  const loadImages = async () => {\n    setLoading(true)\n    try {\n      const result = await window.gemini.listImages()\n      if (result.success && result.images) {\n        setImages(result.images)\n      }\n    } catch (error) {\n      console.error('Failed to load images:', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleNavigate = (img: string) => {\n    if (onGoToImage) {\n      onGoToImage(img)\n      onClose()\n    }\n  }\n\n  if (!isOpen) return null\n\n  return (\n    <div className=\"absolute inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm animate-in fade-in duration-200\">\n      <div className=\"bg-[#1e1f20] border border-gray-800 w-[90%] max-w-4xl h-[80%] rounded-2xl shadow-2xl flex flex-col overflow-hidden\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between px-6 py-4 border-b border-gray-800 bg-[#2b2d30]\">\n          <h2 className=\"text-xl font-semibold text-white\">My Stuff</h2>\n          <button\n            onClick={onClose}\n            className=\"p-2 hover:bg-white/10 rounded-full transition-colors text-gray-400 hover:text-white\"\n          >\n            <X size={20} />\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"flex-1 overflow-y-auto p-6 bg-[#131314]\">\n          {loading ? (\n            <div className=\"flex items-center justify-center h-full text-gray-400\">\n              Loading gallery...\n            </div>\n          ) : images.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center h-full text-gray-500\">\n              <div className=\"w-16 h-16 bg-gray-800 rounded-2xl mb-4 flex items-center justify-center\">\n                <span className=\"text-2xl\"></span>\n              </div>\n              <p>No images saved yet.</p>\n              <p className=\"text-sm mt-2 opacity-60\">Upload images in chat to see them here.</p>\n            </div>\n          ) : (\n            <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">\n              {images.map((img, idx) => {\n                const isVideo =\n                  img.toLowerCase().endsWith('.mp4') ||\n                  img.toLowerCase().endsWith('.webm') ||\n                  img.toLowerCase().endsWith('.mov') ||\n                  img.toLowerCase().endsWith('.avi')\n                return (\n                  <div\n                    key={idx}\n                    className=\"group relative aspect-square bg-gray-900 rounded-xl overflow-hidden border border-gray-800 hover:border-blue-500/50 transition-all cursor-pointer\"\n                  >\n                    {isVideo ? (\n                      <video\n                        src={img}\n                        className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300\"\n                        controls\n                        muted\n                      />\n                    ) : (\n                      <img\n                        src={img}\n                        alt={`Saved ${idx}`}\n                        className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300\"\n                      />\n                    )}\n                    <div className=\"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center pointer-events-none group-hover:pointer-events-auto\">\n                      <button\n                        onClick={() => handleNavigate(img)}\n                        className=\"bg-blue-600 text-white px-3 py-1.5 rounded-lg text-sm font-medium hover:bg-blue-500 transition-colors transform translate-y-2 group-hover:translate-y-0 duration-200\"\n                      >\n                        Go to Chat\n                      </button>\n                    </div>\n                  </div>\n                )\n              })}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\components\\GemManagerModal.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'AlertCircle' is defined but never used.",
        "line": 18,
        "column": 3,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 18,
        "endColumn": 14
      },
      {
        "ruleId": "react-hooks/immutability",
        "severity": 2,
        "message": "Error: Cannot access variable before it is declared\n\n`resetForm` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\components\\GemManagerModal.tsx:69:7\n  67 |   useEffect(() => {\n  68 |     if (isOpen) {\n> 69 |       resetForm()\n     |       ^^^^^^^^^ `resetForm` accessed before it is declared\n  70 |     }\n  71 |   }, [isOpen])\n  72 |\n\nC:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\components\\GemManagerModal.tsx:73:3\n  71 |   }, [isOpen])\n  72 |\n> 73 |   const resetForm = () => {\n     |   ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 74 |     setMode('list')\n     | ^^^^^^^^^^^^^^^^^^^\n> 75 |     setEditingId(null)\n     | ^^^^^^^^^^^^^^^^^^^\n> 76 |     setName('')\n     | ^^^^^^^^^^^^^^^^^^^\n> 77 |     setInstruction('')\n     | ^^^^^^^^^^^^^^^^^^^\n> 78 |     setSelectedIcon('zap')\n     | ^^^^^^^^^^^^^^^^^^^\n> 79 |     setDeletingGem(null)\n     | ^^^^^^^^^^^^^^^^^^^\n> 80 |     setDeleteConfirmation('')\n     | ^^^^^^^^^^^^^^^^^^^\n> 81 |   }\n     | ^^^^ `resetForm` is declared here\n  82 |\n  83 |   const handleStartCreate = () => {\n  84 |     resetForm()",
        "line": 69,
        "column": 7,
        "nodeType": null,
        "endLine": 69,
        "endColumn": 16
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 73,
        "column": 24,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 73,
        "endColumn": 26
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 83,
        "column": 32,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 83,
        "endColumn": 34
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 88,
        "column": 59,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 88,
        "endColumn": 61
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 97,
        "column": 25,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 97,
        "endColumn": 27
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 123,
        "column": 61,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 123,
        "endColumn": 63
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 129,
        "column": 40,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 129,
        "endColumn": 42
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 142,
        "column": 68,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 142,
        "endColumn": 70
      },
      {
        "ruleId": "react/no-unescaped-entities",
        "severity": 2,
        "message": "`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.",
        "line": 168,
        "column": 50,
        "nodeType": "JSXText",
        "messageId": "unescapedEntityAlts",
        "suggestions": [
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&quot;" },
            "fix": { "range": [4812, 4813], "text": "&quot;" },
            "desc": "Replace with `&quot;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&ldquo;" },
            "fix": { "range": [4812, 4813], "text": "&ldquo;" },
            "desc": "Replace with `&ldquo;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&#34;" },
            "fix": { "range": [4812, 4813], "text": "&#34;" },
            "desc": "Replace with `&#34;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&rdquo;" },
            "fix": { "range": [4812, 4813], "text": "&rdquo;" },
            "desc": "Replace with `&rdquo;`."
          }
        ]
      },
      {
        "ruleId": "react/no-unescaped-entities",
        "severity": 2,
        "message": "`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.",
        "line": 168,
        "column": 69,
        "nodeType": "JSXText",
        "messageId": "unescapedEntityAlts",
        "suggestions": [
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&quot;" },
            "fix": { "range": [4831, 4832], "text": "&quot;" },
            "desc": "Replace with `&quot;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&ldquo;" },
            "fix": { "range": [4831, 4832], "text": "&ldquo;" },
            "desc": "Replace with `&ldquo;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&#34;" },
            "fix": { "range": [4831, 4832], "text": "&#34;" },
            "desc": "Replace with `&#34;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&rdquo;" },
            "fix": { "range": [4831, 4832], "text": "&rdquo;" },
            "desc": "Replace with `&rdquo;`."
          }
        ]
      },
      {
        "ruleId": "react/no-unescaped-entities",
        "severity": 2,
        "message": "`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.",
        "line": 182,
        "column": 26,
        "nodeType": "JSXText",
        "messageId": "unescapedEntityAlts",
        "suggestions": [
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&quot;" },
            "fix": {
              "range": [5514, 5578],
              "text": "\n                    Type &quot;DELETE\" to confirm\n                  "
            },
            "desc": "Replace with `&quot;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&ldquo;" },
            "fix": {
              "range": [5514, 5578],
              "text": "\n                    Type &ldquo;DELETE\" to confirm\n                  "
            },
            "desc": "Replace with `&ldquo;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&#34;" },
            "fix": {
              "range": [5514, 5578],
              "text": "\n                    Type &#34;DELETE\" to confirm\n                  "
            },
            "desc": "Replace with `&#34;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&rdquo;" },
            "fix": {
              "range": [5514, 5578],
              "text": "\n                    Type &rdquo;DELETE\" to confirm\n                  "
            },
            "desc": "Replace with `&rdquo;`."
          }
        ]
      },
      {
        "ruleId": "react/no-unescaped-entities",
        "severity": 2,
        "message": "`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.",
        "line": 182,
        "column": 33,
        "nodeType": "JSXText",
        "messageId": "unescapedEntityAlts",
        "suggestions": [
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&quot;" },
            "fix": {
              "range": [5514, 5578],
              "text": "\n                    Type \"DELETE&quot; to confirm\n                  "
            },
            "desc": "Replace with `&quot;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&ldquo;" },
            "fix": {
              "range": [5514, 5578],
              "text": "\n                    Type \"DELETE&ldquo; to confirm\n                  "
            },
            "desc": "Replace with `&ldquo;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&#34;" },
            "fix": {
              "range": [5514, 5578],
              "text": "\n                    Type \"DELETE&#34; to confirm\n                  "
            },
            "desc": "Replace with `&#34;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&rdquo;" },
            "fix": {
              "range": [5514, 5578],
              "text": "\n                    Type \"DELETE&rdquo; to confirm\n                  "
            },
            "desc": "Replace with `&rdquo;`."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 263,
        "column": 75,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 263,
        "endColumn": 78,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [9278, 9281], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [9278, 9281], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 14,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import React, { useState, useEffect } from 'react'\nimport {\n  X,\n  Plus,\n  Trash2,\n  Zap,\n  Play,\n  Brain,\n  Code,\n  PenTool,\n  Sparkles,\n  Smile,\n  Terminal,\n  Briefcase,\n  Coffee,\n  Music,\n  Save,\n  AlertCircle,\n  AlertTriangle\n} from 'lucide-react'\nimport { Gem, StorageService, ChatSession } from '../services/storage'\n\ninterface GemManagerModalProps {\n  isOpen: boolean\n  onClose: () => void\n  onStartGemChat: (gem: Gem) => void\n  onGemUpdated: () => void // Trigger refresh in parent\n  onDeleteGem: (gemId: string) => Promise<void>\n  gems: Gem[]\n  chats: ChatSession[]\n}\n\nconst ICONS = [\n  { name: 'zap', icon: Zap },\n  { name: 'brain', icon: Brain },\n  { name: 'code', icon: Code },\n  { name: 'pen', icon: PenTool },\n  { name: 'sparkles', icon: Sparkles },\n  { name: 'smile', icon: Smile },\n  { name: 'terminal', icon: Terminal },\n  { name: 'briefcase', icon: Briefcase },\n  { name: 'coffee', icon: Coffee },\n  { name: 'music', icon: Music }\n]\n\nexport function GemManagerModal({\n  isOpen,\n  onClose,\n  onStartGemChat,\n  onGemUpdated,\n  onDeleteGem,\n  gems,\n  chats\n}: GemManagerModalProps): JSX.Element | null {\n  const [mode, setMode] = useState<'list' | 'create' | 'edit'>('list')\n  const [editingId, setEditingId] = useState<string | null>(null)\n\n  // Form State\n  const [name, setName] = useState('')\n  const [instruction, setInstruction] = useState('')\n  const [selectedIcon, setSelectedIcon] = useState('zap')\n\n  // Deletion State\n  const [deletingGem, setDeletingGem] = useState<Gem | null>(null)\n  const [deleteConfirmation, setDeleteConfirmation] = useState('')\n\n  useEffect(() => {\n    if (isOpen) {\n      resetForm()\n    }\n  }, [isOpen])\n\n  const resetForm = () => {\n    setMode('list')\n    setEditingId(null)\n    setName('')\n    setInstruction('')\n    setSelectedIcon('zap')\n    setDeletingGem(null)\n    setDeleteConfirmation('')\n  }\n\n  const handleStartCreate = () => {\n    resetForm()\n    setMode('create')\n  }\n\n  const handleStartEdit = (gem: Gem, e: React.MouseEvent) => {\n    e.stopPropagation()\n    setName(gem.name)\n    setInstruction(gem.instruction)\n    setSelectedIcon(gem.icon || 'zap')\n    setEditingId(gem.id)\n    setMode('edit')\n  }\n\n  const handleSave = () => {\n    if (!name.trim() || !instruction.trim()) return\n\n    if (mode === 'create') {\n      const newGem: Gem = {\n        id: Date.now().toString(),\n        name: name.trim(),\n        icon: selectedIcon,\n        instruction: instruction.trim()\n      }\n      StorageService.addGem(newGem)\n    } else if (mode === 'edit' && editingId) {\n      const updatedGem: Gem = {\n        id: editingId,\n        name: name.trim(),\n        icon: selectedIcon,\n        instruction: instruction.trim()\n      }\n      StorageService.updateGem(updatedGem)\n    }\n\n    onGemUpdated()\n    resetForm()\n  }\n\n  // Initial click on delete icon\n  const handleStartDelete = (gem: Gem, e: React.MouseEvent) => {\n    e.stopPropagation()\n    setDeletingGem(gem)\n    setDeleteConfirmation('')\n  }\n\n  const handleConfirmDelete = async () => {\n    if (!deletingGem) return\n    if (deleteConfirmation !== 'DELETE') return\n\n    await onDeleteGem(deletingGem.id)\n    setDeletingGem(null)\n    setDeleteConfirmation('')\n    // If we were editing this gem, reset\n    if (editingId === deletingGem.id) {\n      resetForm()\n    }\n  }\n\n  const renderIcon = (iconName: string, size = 18, className = '') => {\n    const IconComponent = ICONS.find((i) => i.name === iconName)?.icon || Zap\n    return <IconComponent size={size} className={className} />\n  }\n\n  if (!isOpen) return null\n\n  // Count affected chats\n  const affectedChatsCount = deletingGem\n    ? chats.filter((c) => c.gemId === deletingGem.id).length\n    : 0\n\n  return (\n    <div className=\"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm animate-in fade-in duration-200\">\n      <div className=\"bg-[#1e1f20] w-[850px] h-[600px] rounded-[24px] shadow-2xl border border-[#37383a] flex flex-col overflow-hidden text-[#e3e3e3] font-sans relative\">\n        {/* Deletion Overlay */}\n        {deletingGem && (\n          <div className=\"absolute inset-0 z-50 bg-[#1e1f20]/90 backdrop-blur-md flex items-center justify-center p-8 animate-in fade-in\">\n            <div className=\"bg-[#1a1b1c] border border-red-500/30 rounded-2xl p-8 max-w-md w-full shadow-2xl\">\n              <div className=\"flex flex-col items-center text-center space-y-4\">\n                <div className=\"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mb-2\">\n                  <AlertTriangle size={32} className=\"text-red-500\" />\n                </div>\n                <h3 className=\"text-xl font-bold text-white\">Delete Gem?</h3>\n                <p className=\"text-gray-400 text-sm\">\n                  This will permanently delete{' '}\n                  <strong className=\"text-white\">\"{deletingGem.name}\"</strong> and all related data.\n                </p>\n\n                {affectedChatsCount > 0 && (\n                  <div className=\"bg-red-500/10 border border-red-500/20 px-4 py-3 rounded-xl w-full flex items-center gap-3\">\n                    <Trash2 size={16} className=\"text-red-400 shrink-0\" />\n                    <span className=\"text-red-200 text-sm font-medium\">\n                      {affectedChatsCount} chat conversations will also be deleted.\n                    </span>\n                  </div>\n                )}\n\n                <div className=\"w-full pt-4\">\n                  <label className=\"block text-xs font-bold text-gray-500 uppercase tracking-widest mb-2\">\n                    Type \"DELETE\" to confirm\n                  </label>\n                  <input\n                    className=\"w-full bg-[#000] border border-red-900/50 focus:border-red-500 rounded-xl px-4 py-3 text-center font-mono placeholder-gray-700 outline-none transition-colors\"\n                    placeholder=\"DELETE\"\n                    value={deleteConfirmation}\n                    onChange={(e) => setDeleteConfirmation(e.target.value)}\n                    autoFocus\n                  />\n                </div>\n\n                <div className=\"flex gap-3 w-full pt-4\">\n                  <button\n                    onClick={() => setDeletingGem(null)}\n                    className=\"flex-1 px-4 py-3 bg-[#2c2d2e] hover:bg-[#3c4043] rounded-xl font-medium transition-colors\"\n                  >\n                    Cancel\n                  </button>\n                  <button\n                    onClick={handleConfirmDelete}\n                    disabled={deleteConfirmation !== 'DELETE'}\n                    className=\"flex-1 px-4 py-3 bg-red-600 hover:bg-red-500 disabled:opacity-50 disabled:cursor-not-allowed rounded-xl font-medium transition-colors text-white shadow-lg shadow-red-900/20\"\n                  >\n                    Delete Forever\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Header */}\n        <div className=\"flex items-center justify-between px-6 py-4 border-b border-[#37383a] bg-[#222324]\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-8 h-8 rounded-full bg-gradient-to-tr from-amber-400/20 to-orange-400/20 flex items-center justify-center border border-amber-500/20\">\n              <Sparkles className=\"text-[#f4b400]\" size={16} />\n            </div>\n            <div>\n              <h2 className=\"text-lg font-medium\">Gem Manager</h2>\n              <p className=\"text-xs text-gray-500\">Create custom personas and system prompts</p>\n            </div>\n          </div>\n          <button\n            onClick={onClose}\n            className=\"p-2 text-gray-400 hover:text-white hover:bg-[#3c4043] rounded-full transition-colors\"\n          >\n            <X size={20} />\n          </button>\n        </div>\n\n        {/* Main Layout */}\n        <div className=\"flex-1 flex overflow-hidden\">\n          {/* Left Sidebar: List */}\n          <div className=\"w-[280px] bg-[#1a1b1c] border-r border-[#37383a] flex flex-col\">\n            <div className=\"p-4 border-b border-[#37383a]/50\">\n              <button\n                onClick={handleStartCreate}\n                className={`w-full flex items-center justify-center gap-2 p-3 rounded-xl transition-all border ${\n                  mode === 'create'\n                    ? 'bg-[#f4b400]/10 border-[#f4b400]/50 text-[#f4b400]'\n                    : 'bg-[#2c2d2e] border-transparent hover:border-gray-600 text-gray-300 hover:text-white'\n                }`}\n              >\n                <Plus size={18} />\n                <span className=\"font-medium text-sm\">Create New Gem</span>\n              </button>\n            </div>\n\n            <div className=\"flex-1 overflow-y-auto p-3 space-y-1 custom-scrollbar\">\n              {gems.length === 0 && (\n                <div className=\"text-center py-8 opacity-40\">\n                  <Sparkles size={24} className=\"mx-auto mb-2\" />\n                  <p className=\"text-xs\">No Gems yet</p>\n                </div>\n              )}\n\n              {gems.map((gem) => (\n                <div\n                  key={gem.id}\n                  onClick={() => {\n                    if (mode === 'edit' && editingId === gem.id) return // Already editing\n                    handleStartEdit(gem, { stopPropagation: () => {} } as any)\n                  }}\n                  className={`group flex items-center gap-3 p-3 rounded-xl cursor-pointer transition-all border ${\n                    mode === 'edit' && editingId === gem.id\n                      ? 'bg-[#2c2d2e] border-[#f4b400]/50 shadow-md transform scale-[1.02]'\n                      : 'border-transparent hover:bg-[#252627] hover:border-gray-700'\n                  }`}\n                >\n                  <div\n                    className={`w-9 h-9 rounded-full flex items-center justify-center transition-colors ${\n                      mode === 'edit' && editingId === gem.id\n                        ? 'bg-[#f4b400]/20 text-[#f4b400]'\n                        : 'bg-[#3c4043] text-gray-400 group-hover:text-gray-200'\n                    }`}\n                  >\n                    {renderIcon(gem.icon, 16)}\n                  </div>\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"font-medium text-sm truncate text-gray-200\">{gem.name}</div>\n                    <div className=\"text-[10px] text-gray-500 truncate\">\n                      {gem.instruction.slice(0, 30)}...\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-center opacity-0 group-hover:opacity-100 transition-opacity\">\n                    <button\n                      onClick={(e) => handleStartDelete(gem, e)}\n                      className=\"p-1.5 rounded-lg transition-colors hover:bg-red-500/10 hover:text-red-400 text-gray-500\"\n                      title=\"Delete\"\n                    >\n                      <Trash2 size={14} />\n                    </button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          {/* Right Content: Editor or Preview */}\n          <div className=\"flex-1 bg-[#1e1f20] flex flex-col\">\n            {mode === 'list' ? (\n              <div className=\"flex-1 flex flex-col items-center justify-center text-center p-8 opacity-60\">\n                <div className=\"w-20 h-20 bg-[#2c2d2e] rounded-full flex items-center justify-center mb-6 animate-pulse\">\n                  <Sparkles size={40} className=\"text-[#f4b400]\" />\n                </div>\n                <h3 className=\"text-xl font-medium mb-2 text-white\">Select a Gem to Edit</h3>\n                <p className=\"text-gray-400 max-w-sm mb-8 text-sm leading-relaxed\">\n                  Or create a new one to start chatting with a custom persona. Gems define how the\n                  AI behaves and responds.\n                </p>\n                {gems.length > 0 && (\n                  <div className=\"grid grid-cols-2 gap-3 w-full max-w-md\">\n                    {gems.slice(0, 4).map((g) => (\n                      <button\n                        key={g.id}\n                        onClick={() => {\n                          onStartGemChat(g)\n                          onClose()\n                        }}\n                        className=\"flex items-center gap-2 p-3 bg-[#252627] rounded-lg hover:bg-[#2c2d2e] border border-gray-800 hover:border-gray-600 transition-all text-left group\"\n                      >\n                        <div className=\"w-6 h-6 rounded bg-[#f4b400]/10 flex items-center justify-center text-[#f4b400]\">\n                          {renderIcon(g.icon, 12)}\n                        </div>\n                        <span className=\"text-sm text-gray-300 group-hover:text-white\">\n                          {g.name}\n                        </span>\n                        <Play size={12} className=\"ml-auto opacity-0 group-hover:opacity-50\" />\n                      </button>\n                    ))}\n                  </div>\n                )}\n              </div>\n            ) : (\n              <div className=\"flex-1 flex flex-col animate-in fade-in slide-in-from-right-4 duration-300\">\n                <div className=\"p-6 flex-1 overflow-y-auto\">\n                  <div className=\"flex items-center justify-between mb-6\">\n                    <h3 className=\"text-xl font-medium flex items-center gap-2\">\n                      {mode === 'create' ? (\n                        <>\n                          <span className=\"text-[#f4b400]\">New Gem</span>\n                        </>\n                      ) : (\n                        <>\n                          <span className=\"text-gray-400\">Editing</span>\n                          <span className=\"text-white\">{name || 'Untitled'}</span>\n                        </>\n                      )}\n                    </h3>\n                    <div className=\"flex gap-2\">\n                      {mode === 'edit' && (\n                        <button\n                          onClick={() => {\n                            const gem = gems.find((g) => g.id === editingId)\n                            if (gem) {\n                              onStartGemChat(gem)\n                              onClose()\n                            }\n                          }}\n                          className=\"px-4 py-2 bg-[#2c2d2e] text-[#8ab4f8] rounded-lg hover:bg-[#37383a] text-sm font-medium flex items-center gap-2 transition-colors\"\n                        >\n                          <Play size={14} />\n                          Start Chat\n                        </button>\n                      )}\n                      <button\n                        onClick={resetForm}\n                        className=\"px-4 py-2 bg-[#2c2d2e] text-gray-300 rounded-lg hover:bg-[#37383a] text-sm font-medium transition-colors\"\n                      >\n                        Cancel\n                      </button>\n                      <button\n                        onClick={handleSave}\n                        disabled={!name.trim() || !instruction.trim()}\n                        className=\"px-6 py-2 bg-[#f4b400] text-black font-medium rounded-lg hover:bg-[#fdd663] text-sm flex items-center gap-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-amber-900/20\"\n                      >\n                        <Save size={16} />\n                        Save Gem\n                      </button>\n                    </div>\n                  </div>\n\n                  <div className=\"space-y-6 max-w-2xl mx-auto\">\n                    {/* Icon Selector */}\n                    <div>\n                      <label className=\"block text-xs font-medium text-gray-400 uppercase tracking-wider mb-3\">\n                        Icon\n                      </label>\n                      <div className=\"flex flex-wrap gap-2 bg-[#252627] p-4 rounded-xl border border-[#37383a]\">\n                        {ICONS.map((item) => (\n                          <button\n                            key={item.name}\n                            onClick={() => setSelectedIcon(item.name)}\n                            className={`w-10 h-10 rounded-lg flex items-center justify-center transition-all ${\n                              selectedIcon === item.name\n                                ? 'bg-[#f4b400] text-black shadow-lg scale-110'\n                                : 'bg-[#2c2d2e] text-gray-400 hover:bg-[#3c4043] hover:text-white'\n                            }`}\n                            title={item.name}\n                          >\n                            <item.icon size={20} />\n                          </button>\n                        ))}\n                      </div>\n                    </div>\n\n                    {/* Name Input */}\n                    <div>\n                      <label className=\"block text-xs font-medium text-gray-400 uppercase tracking-wider mb-2\">\n                        Gem Name\n                      </label>\n                      <input\n                        className=\"w-full bg-[#252627] border border-[#37383a] rounded-xl px-4 py-3 focus:border-[#f4b400] outline-none text-[#e3e3e3] placeholder-gray-600 transition-colors\"\n                        placeholder=\"e.g. Senior React Developer\"\n                        value={name}\n                        onChange={(e) => setName(e.target.value)}\n                        autoFocus\n                      />\n                    </div>\n\n                    {/* Instruction Input */}\n                    <div>\n                      <label className=\"block text-xs font-medium text-gray-400 uppercase tracking-wider mb-2\">\n                        System Instructions\n                        <span className=\"ml-2 normal-case text-gray-500 font-normal opacity-70\">\n                          - Define the persona and behavior\n                        </span>\n                      </label>\n                      <div className=\"relative\">\n                        <textarea\n                          className=\"w-full bg-[#252627] border border-[#37383a] rounded-xl px-4 py-4 focus:border-[#f4b400] outline-none min-h-[250px] resize-none text-[#e3e3e3] placeholder-gray-600 leading-relaxed custom-scrollbar transition-colors\"\n                          placeholder=\"You are an expert software engineer specializing in React and TypeScript. Always provide type-safe examples and explain best practices...\"\n                          value={instruction}\n                          onChange={(e) => setInstruction(e.target.value)}\n                        />\n                        <div className=\"absolute bottom-4 right-4 text-xs text-gray-600 bg-[#252627]/80 backdrop-blur px-2 py-1 rounded\">\n                          {instruction.length} chars\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\components\\Layout.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 13,
        "column": 8,
        "nodeType": "FunctionDeclaration",
        "messageId": "missingReturnType",
        "endLine": 13,
        "endColumn": 23
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 38,
        "column": 29,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 38,
        "endColumn": 32,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1570, 1573], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1570, 1573], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 44,
        "column": 27,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 44,
        "endColumn": 29
      },
      {
        "ruleId": "react-hooks/set-state-in-effect",
        "severity": 2,
        "message": "Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\components\\Layout.tsx:94:5\n  92 |   // Initial Data Load\n  93 |   useEffect(() => {\n> 94 |     loadData()\n     |     ^^^^^^^^ Avoid calling setState() directly within an effect\n  95 |   }, [loadData])\n  96 |\n  97 |   // Refresh images occasionally or when chats update",
        "line": 94,
        "column": 5,
        "nodeType": null,
        "endLine": 94,
        "endColumn": 13
      },
      {
        "ruleId": "react-hooks/set-state-in-effect",
        "severity": 2,
        "message": "Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\components\\Layout.tsx:99:5\n   97 |   // Refresh images occasionally or when chats update\n   98 |   useEffect(() => {\n>  99 |     fetchImages()\n      |     ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  100 |   }, [chats, fetchImages]) // When chat updates, maybe new image was added\n  101 |\n  102 |   const handleSelectChat = (id: string) => {",
        "line": 99,
        "column": 5,
        "nodeType": null,
        "endLine": 99,
        "endColumn": 16
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 102,
        "column": 41,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 102,
        "endColumn": 43
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 109,
        "column": 55,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 109,
        "endColumn": 57
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 131,
        "column": 69,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 131,
        "endColumn": 71
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 145,
        "column": 49,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 145,
        "endColumn": 51
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 168,
        "column": 44,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 168,
        "endColumn": 46
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 204,
        "column": 28,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 204,
        "endColumn": 30
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'_initialMessage' is defined but never used.",
        "line": 211,
        "column": 35,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 211,
        "endColumn": 50
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 231,
        "column": 5,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 231,
        "endColumn": 7
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 236,
        "column": 41,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 236,
        "endColumn": 43
      },
      {
        "ruleId": "react/no-unknown-property",
        "severity": 2,
        "message": "Unknown property 'useragent' found",
        "line": 296,
        "column": 17,
        "nodeType": "JSXAttribute",
        "messageId": "unknownProp",
        "endLine": 296,
        "endColumn": 38
      },
      {
        "ruleId": "react/no-unknown-property",
        "severity": 2,
        "message": "Unknown property 'partition' found",
        "line": 297,
        "column": 17,
        "nodeType": "JSXAttribute",
        "messageId": "unknownProp",
        "endLine": 297,
        "endColumn": 43
      }
    ],
    "suppressedMessages": [],
    "errorCount": 16,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import React, { useState, useEffect, useRef, useCallback } from 'react'\nimport { Sidebar } from './Sidebar'\nimport { ChatArea } from './ChatArea'\nimport { SettingsModal } from './SettingsModal'\nimport { GemManagerModal } from './GemManagerModal'\nimport { GalleryModal } from './GalleryModal'\nimport { Globe, Terminal } from 'lucide-react'\nimport { StorageService, ChatSession, AppSettings, Gem } from '../services/storage'\nimport { ChatMessage } from '../types'\n\ntype AppMode = 'web' | 'api'\n\nexport function Layout() {\n  const [mode, setMode] = useState<AppMode>('web')\n  const [chats, setChats] = useState<ChatSession[]>([])\n  const [activeChatId, setActiveChatId] = useState<string | null>(null)\n\n  // Config State\n  const [settings, setSettings] = useState<AppSettings>(StorageService.getSettings())\n  const [currentGemInstruction, setCurrentGemInstruction] = useState<string | undefined>(undefined)\n  const [currentGemId, setCurrentGemId] = useState<string | undefined>(undefined)\n\n  // Data State\n  const [gems, setGems] = useState<Gem[]>([])\n  const [recentImages, setRecentImages] = useState<string[]>([])\n  const [userAgent, setUserAgent] = useState<string>('')\n\n  // Modals\n  const [showSettings, setShowSettings] = useState(false)\n  const [showGemManager, setShowGemManager] = useState(false)\n  const [showGallery, setShowGallery] = useState(false)\n\n  // Sidebar State\n  const [isSidebarCollapsed, setIsSidebarCollapsed] = useState(false)\n\n  const [highlightedImage, setHighlightedImage] = useState<string | undefined>(undefined)\n\n  const webviewRef = useRef<any>(null)\n\n  useEffect(() => {\n    const webview = webviewRef.current\n    if (!webview) return\n\n    const onDomReady = () => {\n      // Anti-fingerprinting: Delete navigator.webdriver and ChromeDriver variables\n      webview.executeJavaScript(`\n                // 1. Remove navigator.webdriver\n                const newProto = navigator.__proto__;\n                delete newProto.webdriver;\n                navigator.__proto__ = newProto;\n\n                // 2. Remove ChromeDriver \"cdc_\" variable\n                const key = Object.keys(window).find(key => key.startsWith('cdc_'));\n                if(key) delete window[key];\n            `)\n    }\n\n    webview.addEventListener('dom-ready', onDomReady)\n    return () => {\n      webview.removeEventListener('dom-ready', onDomReady)\n    }\n  }, [userAgent, mode])\n\n  const fetchImages = useCallback(async () => {\n    try {\n      const result = await window.gemini.listImages()\n      if (result.success && result.images) {\n        setRecentImages(result.images)\n      }\n    } catch (e) {\n      console.error('Failed to fetch images', e)\n    }\n  }, [])\n\n  const loadData = useCallback(async () => {\n    setChats(StorageService.getChats())\n    setGems(StorageService.getGems())\n    fetchImages()\n    // Fetch platform-specific User-Agent from main process to support both Mac and Windows\n    try {\n      const ua = await window.gemini.getUserAgent()\n      setUserAgent(ua)\n    } catch (e) {\n      console.error('Failed to get User-Agent:', e)\n      // Fallback to Windows Firefox if IPC fails\n      setUserAgent(\n        'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:133.0) Gecko/20100101 Firefox/133.0'\n      )\n    }\n  }, [fetchImages])\n\n  // Initial Data Load\n  useEffect(() => {\n    loadData()\n  }, [loadData])\n\n  // Refresh images occasionally or when chats update\n  useEffect(() => {\n    fetchImages()\n  }, [chats, fetchImages]) // When chat updates, maybe new image was added\n\n  const handleSelectChat = (id: string) => {\n    setActiveChatId(id)\n    setCurrentGemInstruction(undefined)\n    setCurrentGemId(undefined)\n    setHighlightedImage(undefined)\n  }\n\n  const cleanupChatImages = async (chat: ChatSession) => {\n    const imagesToDelete: string[] = []\n    chat.messages.forEach((msg) => {\n      if (msg.images) {\n        msg.images.forEach((img) => {\n          if (img.startsWith('gemini-media://')) {\n            const filename = img.replace('gemini-media://', '')\n            imagesToDelete.push(filename)\n          }\n        })\n      }\n    })\n\n    if (imagesToDelete.length > 0) {\n      try {\n        await Promise.all(imagesToDelete.map((filename) => window.gemini.deleteImage({ filename })))\n      } catch (err) {\n        console.error('Failed to cleanup images for chat', chat.id, err)\n      }\n    }\n  }\n\n  const handleDeleteChat = async (id: string, e?: React.MouseEvent) => {\n    if (e) e.stopPropagation()\n\n    // Find chat to get images\n    const chatToDelete = chats.find((c) => c.id === id)\n    if (chatToDelete) {\n      await cleanupChatImages(chatToDelete)\n    }\n\n    StorageService.deleteChat(id)\n    loadData()\n    if (activeChatId === id) setActiveChatId(null)\n  }\n\n  const handleDeleteGem = async (gemId: string) => {\n    // Find links\n    const chatsToDelete = chats.filter((c) => c.gemId === gemId)\n\n    // 1. Cleanup all chats (images + sessions)\n    for (const chat of chatsToDelete) {\n      await cleanupChatImages(chat)\n      StorageService.deleteChat(chat.id)\n    }\n\n    // 2. Delete Gem\n    StorageService.deleteGem(gemId)\n\n    // 3. Reset UI if active chat was in this gem\n    if (activeChatId && chatsToDelete.find((c) => c.id === activeChatId)) {\n      setActiveChatId(null)\n      setCurrentGemInstruction(undefined)\n      setCurrentGemId(undefined)\n    }\n\n    loadData()\n  }\n\n  const handleGoToImage = (imgSrc: string) => {\n    // Find which chat contains this image\n    // imgSrc is likely \"gemini-media://filename\" or just filename, depending on how recentImages is stored\n    // recentImages comes from listImages which returns filenames usually? Or full paths?\n    // window.gemini.listImages returns filenames or `gemini-media://${filename}`?\n    // Let's assume the src matches what's in the message.images array exactly or partially.\n\n    // Scan all chats\n    for (const chat of chats) {\n      for (const msg of chat.messages) {\n        if (msg.images && msg.images.includes(imgSrc)) {\n          setActiveChatId(chat.id)\n          setHighlightedImage(imgSrc)\n          return\n        }\n      }\n    }\n\n    // Fallback: If not exact match, try checking filename\n    const targetFilename = imgSrc.split('/').pop()\n    if (!targetFilename) return\n\n    for (const chat of chats) {\n      for (const msg of chat.messages) {\n        if (msg.images) {\n          const match = msg.images.find((img) => img.endsWith(targetFilename))\n          if (match) {\n            setActiveChatId(chat.id)\n            setHighlightedImage(match)\n            return\n          }\n        }\n      }\n    }\n  }\n\n  const handleNewChat = () => {\n    setActiveChatId(null)\n    setCurrentGemInstruction(undefined)\n    setCurrentGemId(undefined)\n    setHighlightedImage(undefined)\n  }\n\n  const handleCreateChat = async (_initialMessage: string): Promise<string> => {\n    const newId = Date.now().toString(36) + Math.random().toString(36).substr(2)\n    const newChat: ChatSession = {\n      id: newId,\n      title: 'New Chat',\n      messages: [],\n      updatedAt: Date.now(),\n      gemId: currentGemId // Link to current gem if active\n    }\n    StorageService.addChat(newChat)\n    loadData()\n    setActiveChatId(newId)\n    return newId\n  }\n\n  const handleUpdateChat = (\n    id: string,\n    messages: ChatMessage[],\n    title?: string,\n    modelId?: string\n  ) => {\n    StorageService.updateChat(id, messages, title, modelId)\n    loadData()\n  }\n\n  const handleStartGemChat = (gem: Gem) => {\n    // Start a new chat context with this gem's instruction\n    setActiveChatId(null)\n    setCurrentGemInstruction(gem.instruction)\n    setCurrentGemId(gem.id)\n    setShowGemManager(false)\n    setHighlightedImage(undefined)\n  }\n\n  const activeApiKey = settings.apiKeys.find((k) => k.id === settings.activeKeyId)?.key || ''\n\n  return (\n    <div className=\"flex flex-col h-screen w-screen overflow-hidden bg-transparent rounded-xl relative\">\n      {/* Draggable Title Bar Area - Top Level, Full Width */}\n      <div className=\"h-8 w-full drag-region z-50 flex justify-center items-center pointer-events-none absolute top-0 left-0 bg-transparent\">\n        <div className=\"drag-none pointer-events-auto bg-gray-900/90 backdrop-blur rounded-full p-1 flex gap-1 border border-gray-800 mt-2\">\n          <button\n            onClick={() => setMode('web')}\n            className={`p-1.5 rounded-full transition-colors ${mode === 'web' ? 'bg-blue-600 text-white shadow-sm' : 'text-gray-400 hover:text-white'}`}\n            title=\"Web Mode (gemini.google.com)\"\n          >\n            <Globe size={14} />\n          </button>\n          <button\n            onClick={() => setMode('api')}\n            className={`p-1.5 rounded-full transition-colors ${mode === 'api' ? 'bg-purple-600 text-white shadow-sm' : 'text-gray-400 hover:text-white'}`}\n            title=\"API Mode (Custom Chat)\"\n          >\n            <Terminal size={14} />\n          </button>\n        </div>\n      </div>\n\n      {/* Main Content Area */}\n      <div className=\"flex-1 flex w-full h-full pt-8 bg-gray-950 overflow-hidden\">\n        {mode === 'api' && (\n          <Sidebar\n            chats={chats}\n            gems={gems}\n            recentImages={recentImages}\n            activeId={activeChatId}\n            onSelect={handleSelectChat}\n            onDelete={handleDeleteChat}\n            onNewChat={handleNewChat}\n            onOpenSettings={() => setShowSettings(true)}\n            onOpenGemManager={() => setShowGemManager(true)}\n            onOpenGallery={() => setShowGallery(true)}\n            onGoToImage={handleGoToImage}\n            collapsed={isSidebarCollapsed}\n            onToggle={() => setIsSidebarCollapsed(!isSidebarCollapsed)}\n          />\n        )}\n\n        <div className=\"flex-1 h-full min-w-0 relative flex flex-col\">\n          {mode === 'web' ? (\n            userAgent ? (\n              <webview\n                ref={webviewRef}\n                src=\"https://gemini.google.com\"\n                className=\"w-full h-full\"\n                useragent={userAgent}\n                partition=\"persist:gemini\"\n              />\n            ) : (\n              <div className=\"flex items-center justify-center h-full text-gray-400\">\n                Initializing Secure Session...\n              </div>\n            )\n          ) : (\n            <ChatArea\n              activeChatId={activeChatId}\n              onUpdateChat={handleUpdateChat}\n              onCreateChat={handleCreateChat}\n              apiKey={activeApiKey}\n              modelName={settings.activeModel}\n              systemInstruction={currentGemInstruction}\n              onOpenSettings={() => setShowSettings(true)}\n              highlightedImage={highlightedImage}\n              userName={settings.username}\n              globalInstructions={settings.globalInstructions}\n            />\n          )}\n        </div>\n      </div>\n\n      {/* Modals */}\n      <SettingsModal\n        isOpen={showSettings}\n        onClose={() => setShowSettings(false)}\n        onSettingsChanged={setSettings}\n        onImagesCleared={fetchImages}\n      />\n      <GemManagerModal\n        isOpen={showGemManager}\n        onClose={() => setShowGemManager(false)}\n        onStartGemChat={handleStartGemChat}\n        gems={gems}\n        chats={chats}\n        onGemUpdated={loadData}\n        onDeleteGem={handleDeleteGem}\n      />\n      <GalleryModal\n        isOpen={showGallery}\n        onClose={() => setShowGallery(false)}\n        onGoToImage={handleGoToImage}\n      />\n    </div>\n  )\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\components\\SettingsModal.tsx",
    "messages": [
      {
        "ruleId": "react-hooks/set-state-in-effect",
        "severity": 2,
        "message": "Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\components\\SettingsModal.tsx:34:7\n  32 |     if (isOpen) {\n  33 |       const saved = StorageService.getSettings()\n> 34 |       setSettings(saved)\n     |       ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  35 |       // Check if current model is one of the presets\n  36 |       const isPreset = SETTINGS_MODELS.some((m) => m.id === saved.activeModel)\n  37 |       if (!isPreset && saved.activeModel) {",
        "line": 34,
        "column": 7,
        "nodeType": null,
        "endLine": 34,
        "endColumn": 18
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 46,
        "column": 57,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 46,
        "endColumn": 59
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 52,
        "column": 27,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 52,
        "endColumn": 29
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 71,
        "column": 40,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 71,
        "endColumn": 42
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 81,
        "column": 43,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 81,
        "endColumn": 45
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 85,
        "column": 71,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 85,
        "endColumn": 73
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 96,
        "column": 36,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 96,
        "endColumn": 38
      },
      {
        "ruleId": "react/no-unescaped-entities",
        "severity": 2,
        "message": "`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.",
        "line": 203,
        "column": 44,
        "nodeType": "JSXText",
        "messageId": "unescapedEntityAlts",
        "suggestions": [
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&quot;" },
            "fix": {
              "range": [7770, 7847],
              "text": "\n                  Used for greetings (e.g. &quot;Hello, [Name]\")\n                "
            },
            "desc": "Replace with `&quot;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&ldquo;" },
            "fix": {
              "range": [7770, 7847],
              "text": "\n                  Used for greetings (e.g. &ldquo;Hello, [Name]\")\n                "
            },
            "desc": "Replace with `&ldquo;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&#34;" },
            "fix": {
              "range": [7770, 7847],
              "text": "\n                  Used for greetings (e.g. &#34;Hello, [Name]\")\n                "
            },
            "desc": "Replace with `&#34;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&rdquo;" },
            "fix": {
              "range": [7770, 7847],
              "text": "\n                  Used for greetings (e.g. &rdquo;Hello, [Name]\")\n                "
            },
            "desc": "Replace with `&rdquo;`."
          }
        ]
      },
      {
        "ruleId": "react/no-unescaped-entities",
        "severity": 2,
        "message": "`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.",
        "line": 203,
        "column": 58,
        "nodeType": "JSXText",
        "messageId": "unescapedEntityAlts",
        "suggestions": [
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&quot;" },
            "fix": {
              "range": [7770, 7847],
              "text": "\n                  Used for greetings (e.g. \"Hello, [Name]&quot;)\n                "
            },
            "desc": "Replace with `&quot;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&ldquo;" },
            "fix": {
              "range": [7770, 7847],
              "text": "\n                  Used for greetings (e.g. \"Hello, [Name]&ldquo;)\n                "
            },
            "desc": "Replace with `&ldquo;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&#34;" },
            "fix": {
              "range": [7770, 7847],
              "text": "\n                  Used for greetings (e.g. \"Hello, [Name]&#34;)\n                "
            },
            "desc": "Replace with `&#34;`."
          },
          {
            "messageId": "replaceWithAlt",
            "data": { "alt": "&rdquo;" },
            "fix": {
              "range": [7770, 7847],
              "text": "\n                  Used for greetings (e.g. \"Hello, [Name]&rdquo;)\n                "
            },
            "desc": "Replace with `&rdquo;`."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 9,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import React, { useState, useEffect } from 'react'\nimport { X, Plus, Trash2, Key, Check } from 'lucide-react'\nimport { AppSettings, StorageService } from '../services/storage'\nimport { MODELS } from '../constants/models'\n\ninterface SettingsModalProps {\n  isOpen: boolean\n  onClose: () => void\n  onSettingsChanged: (settings: AppSettings) => void\n  onImagesCleared?: () => void\n}\n\n// Add \"Custom\" option to the shared list for Settings only\nconst SETTINGS_MODELS = [...MODELS, { id: 'custom', name: 'Custom Model ID...' }]\n\nexport function SettingsModal({\n  isOpen,\n  onClose,\n  onSettingsChanged,\n  onImagesCleared\n}: SettingsModalProps): JSX.Element {\n  const [settings, setSettings] = useState<AppSettings>(StorageService.getSettings())\n  const [newKeyName, setNewKeyName] = useState('')\n  const [newKeyValue, setNewKeyValue] = useState('')\n  const [showAddKey, setShowAddKey] = useState(false)\n  const [customModelId, setCustomModelId] = useState('')\n\n  // We are no longer auto-fetching to respect user preference for specific models\n  const [isCustomMode, setIsCustomMode] = useState(false)\n\n  useEffect(() => {\n    if (isOpen) {\n      const saved = StorageService.getSettings()\n      setSettings(saved)\n      // Check if current model is one of the presets\n      const isPreset = SETTINGS_MODELS.some((m) => m.id === saved.activeModel)\n      if (!isPreset && saved.activeModel) {\n        setIsCustomMode(true)\n        setCustomModelId(saved.activeModel)\n      } else {\n        setIsCustomMode(false)\n      }\n    }\n  }, [isOpen])\n\n  const handleSaveSettings = (newSettings: AppSettings) => {\n    StorageService.saveSettings(newSettings)\n    setSettings(newSettings)\n    onSettingsChanged(newSettings)\n  }\n\n  const handleAddKey = () => {\n    if (!newKeyName || !newKeyValue) return\n    const newKey = {\n      id: Date.now().toString(),\n      name: newKeyName,\n      key: newKeyValue\n    }\n    const updatedKeys = [...settings.apiKeys, newKey]\n    const updatedSettings = {\n      ...settings,\n      apiKeys: updatedKeys,\n      activeKeyId: settings.activeKeyId || newKey.id\n    }\n    handleSaveSettings(updatedSettings)\n    setNewKeyName('')\n    setNewKeyValue('')\n    setShowAddKey(false)\n  }\n\n  const handleDeleteKey = (id: string) => {\n    const updatedKeys = settings.apiKeys.filter((k) => k.id !== id)\n    const updatedSettings = {\n      ...settings,\n      apiKeys: updatedKeys,\n      activeKeyId: settings.activeKeyId === id ? updatedKeys[0]?.id || '' : settings.activeKeyId\n    }\n    handleSaveSettings(updatedSettings)\n  }\n\n  const handleSetActiveKey = (id: string) => {\n    handleSaveSettings({ ...settings, activeKeyId: id })\n  }\n\n  const handleModelChange = (e: React.ChangeEvent<HTMLSelectElement>) => {\n    const val = e.target.value\n    if (val === 'custom') {\n      setIsCustomMode(true)\n      // Don't save yet, wait for text input\n    } else {\n      setIsCustomMode(false)\n      handleSaveSettings({ ...settings, activeModel: val })\n    }\n  }\n\n  const handleCustomModelBlur = () => {\n    if (customModelId) {\n      handleSaveSettings({ ...settings, activeModel: customModelId })\n    }\n  }\n\n  if (!isOpen) return null\n\n  return (\n    <div className=\"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm\">\n      <div className=\"bg-[#1e1f20] w-[600px] max-h-[85vh] rounded-[24px] shadow-2xl border border-[#37383a] flex flex-col overflow-hidden text-[#e3e3e3] font-sans\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between px-6 py-4 border-b border-[#37383a] bg-[#2c2d2e]\">\n          <h2 className=\"text-xl font-medium\">Settings</h2>\n          <button\n            onClick={onClose}\n            className=\"p-2 hover:bg-[#3c4043] rounded-full transition-colors\"\n          >\n            <X size={20} />\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"flex-1 overflow-y-auto p-6 space-y-8\">\n          {/* Storage Management */}\n          <div className=\"mb-6 pt-4 border-t border-gray-800\">\n            <h3 className=\"text-sm font-medium text-gray-400 mb-2\">Storage</h3>\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm text-gray-500\">Manage saved images</span>\n              <button\n                onClick={async () => {\n                  if (\n                    confirm(\n                      'Are you sure you want to delete ALL saved images? This cannot be undone.'\n                    )\n                  ) {\n                    await window.gemini.deleteAllImages()\n                    alert('All images deleted.')\n                    if (onImagesCleared) onImagesCleared()\n                  }\n                }}\n                className=\"text-xs bg-red-500/10 text-red-400 hover:bg-red-500/20 px-3 py-2 rounded-lg transition-colors border border-red-500/20\"\n              >\n                Delete All Images\n              </button>\n            </div>\n          </div>\n\n          {/* Model Config */}\n          <section>\n            <div className=\"flex items-center justify-between mb-4\">\n              <h3 className=\"text-sm font-medium text-[#8ab4f8] uppercase tracking-wider\">\n                Model Selection\n              </h3>\n            </div>\n\n            <div className=\"bg-[#2c2d2e] rounded-xl p-4 space-y-3\">\n              <div>\n                <label className=\"block text-sm text-gray-400 mb-2\">Default Model</label>\n                <select\n                  value={isCustomMode ? 'custom' : settings.activeModel}\n                  onChange={handleModelChange}\n                  className=\"w-full bg-[#1e1f20] border border-gray-600 rounded-lg px-4 py-3 focus:outline-none focus:border-[#8ab4f8] transition-colors appearance-none\"\n                >\n                  {SETTINGS_MODELS.map((m) => (\n                    <option key={m.id} value={m.id}>\n                      {m.name}\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              {isCustomMode && (\n                <div className=\"animate-in fade-in slide-in-from-top-2\">\n                  <label className=\"block text-sm text-gray-400 mb-2\">Enter Custom Model ID</label>\n                  <input\n                    value={customModelId}\n                    onChange={(e) => setCustomModelId(e.target.value)}\n                    onBlur={handleCustomModelBlur}\n                    placeholder=\"e.g. gemini-1.5-pro-latest\"\n                    className=\"w-full bg-[#1e1f20] border border-gray-600 rounded-lg px-4 py-3 focus:outline-none focus:border-[#8ab4f8] font-mono text-sm\"\n                  />\n                  <p className=\"text-xs text-gray-500 mt-2\">\n                    Enter the exact model ID from the API documentation.\n                  </p>\n                </div>\n              )}\n            </div>\n          </section>\n\n          {/* User Profile */}\n          <section>\n            <div className=\"flex items-center justify-between mb-4\">\n              <h3 className=\"text-sm font-medium text-[#8ab4f8] uppercase tracking-wider\">\n                User Profile\n              </h3>\n            </div>\n            <div className=\"bg-[#2c2d2e] rounded-xl p-4 space-y-4\">\n              <div>\n                <label className=\"block text-sm text-gray-400 mb-2\">Display Name</label>\n                <input\n                  value={settings.username || ''}\n                  onChange={(e) => handleSaveSettings({ ...settings, username: e.target.value })}\n                  placeholder=\"User\"\n                  className=\"w-full bg-[#1e1f20] border border-gray-600 rounded-lg px-4 py-3 focus:outline-none focus:border-[#8ab4f8] text-[#e3e3e3] placeholder-gray-600 transition-colors\"\n                />\n                <p className=\"text-xs text-gray-500 mt-2\">\n                  Used for greetings (e.g. \"Hello, [Name]\")\n                </p>\n              </div>\n\n              <div>\n                <label className=\"block text-sm text-gray-400 mb-2\">\n                  Global System Instructions\n                </label>\n                <textarea\n                  value={settings.globalInstructions || ''}\n                  onChange={(e) =>\n                    handleSaveSettings({ ...settings, globalInstructions: e.target.value })\n                  }\n                  placeholder=\"e.g. Always respond in markdown. Be concise. Prefer Python for code examples...\"\n                  className=\"w-full bg-[#1e1f20] border border-gray-600 rounded-lg px-4 py-3 focus:outline-none focus:border-[#8ab4f8] text-[#e3e3e3] placeholder-gray-600 transition-colors min-h-[100px] resize-none\"\n                />\n                <p className=\"text-xs text-gray-500 mt-2\">\n                  These instructions are appended to the start of every chat context, including when\n                  using Gems.\n                </p>\n              </div>\n            </div>\n          </section>\n\n          {/* API Keys */}\n          <section>\n            <div className=\"flex items-center justify-between mb-4\">\n              <h3 className=\"text-sm font-medium text-[#8ab4f8] uppercase tracking-wider\">\n                API Keys\n              </h3>\n              <button\n                onClick={() => setShowAddKey(!showAddKey)}\n                className=\"text-sm flex items-center gap-1 text-[#8ab4f8] hover:text-[#aecbfa]\"\n              >\n                <Plus size={16} /> Add Key\n              </button>\n            </div>\n\n            <div className=\"space-y-3\">\n              {showAddKey && (\n                <div className=\"bg-[#2c2d2e] p-4 rounded-xl border border-[#8ab4f8] mb-4 space-y-3 animate-in fade-in slide-in-from-top-2\">\n                  <input\n                    placeholder=\"Key Name (e.g. My Personal Key)\"\n                    className=\"w-full bg-[#1e1f20] p-2 rounded border border-gray-600 focus:border-[#8ab4f8] outline-none\"\n                    value={newKeyName}\n                    onChange={(e) => setNewKeyName(e.target.value)}\n                  />\n                  <input\n                    placeholder=\"AIzaSy...\"\n                    className=\"w-full bg-[#1e1f20] p-2 rounded border border-gray-600 focus:border-[#8ab4f8] outline-none font-mono text-sm\"\n                    value={newKeyValue}\n                    onChange={(e) => setNewKeyValue(e.target.value)}\n                    type=\"password\"\n                  />\n                  <div className=\"flex justify-end gap-2 mt-2\">\n                    <button\n                      onClick={() => setShowAddKey(false)}\n                      className=\"px-3 py-1.5 text-sm hover:bg-[#3c4043] rounded\"\n                    >\n                      Cancel\n                    </button>\n                    <button\n                      onClick={handleAddKey}\n                      className=\"px-3 py-1.5 text-sm bg-[#8ab4f8] text-[#041e49] rounded font-medium\"\n                    >\n                      Save Key\n                    </button>\n                  </div>\n                </div>\n              )}\n\n              {settings.apiKeys.length === 0 ? (\n                <div className=\"text-center py-8 text-gray-500 bg-[#2c2d2e] rounded-xl border border-dashed border-[#37383a]\">\n                  <Key className=\"mx-auto mb-2 opacity-50\" />\n                  No API Keys found. Add one to start chatting.\n                </div>\n              ) : (\n                settings.apiKeys.map((key) => (\n                  <div\n                    key={key.id}\n                    onClick={() => handleSetActiveKey(key.id)}\n                    className={`flex items-center justify-between p-4 rounded-xl border transition-all cursor-pointer ${\n                      settings.activeKeyId === key.id\n                        ? 'bg-[#004a77]/30 border-[#8ab4f8] shadow-sm'\n                        : 'bg-[#2c2d2e] border-transparent hover:border-gray-600'\n                    }`}\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <div\n                        className={`w-4 h-4 rounded-full border flex items-center justify-center ${\n                          settings.activeKeyId === key.id\n                            ? 'border-[#8ab4f8] bg-[#8ab4f8]'\n                            : 'border-gray-500'\n                        }`}\n                      >\n                        {settings.activeKeyId === key.id && (\n                          <Check size={10} className=\"text-[#041e49]\" />\n                        )}\n                      </div>\n                      <div>\n                        <div className=\"font-medium text-sm\">{key.name}</div>\n                        <div className=\"text-xs text-gray-500 font-mono\">\n                          {key.key.substr(0, 8)}...{key.key.substr(-4)}\n                        </div>\n                      </div>\n                    </div>\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation()\n                        handleDeleteKey(key.id)\n                      }}\n                      className=\"p-2 text-gray-500 hover:text-red-400 hover:bg-[#3c4043] rounded-full transition-colors\"\n                    >\n                      <Trash2 size={16} />\n                    </button>\n                  </div>\n                ))\n              )}\n            </div>\n          </section>\n        </div>\n\n        <div className=\"p-4 border-t border-[#37383a] bg-[#1e1f20] text-center text-xs text-gray-500\">\n          Configuration is encrypted locally using AES-256.\n        </div>\n      </div>\n    </div>\n  )\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\components\\Sidebar.tsx",
    "messages": [
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 51,
        "column": 8,
        "nodeType": "FunctionDeclaration",
        "messageId": "missingReturnType",
        "endLine": 51,
        "endColumn": 24
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 67,
        "column": 36,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 67,
        "endColumn": 38
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 71,
        "column": 71,
        "nodeType": "ArrowFunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 71,
        "endColumn": 73
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 256,
        "column": 1,
        "nodeType": "FunctionDeclaration",
        "messageId": "missingReturnType",
        "endLine": 256,
        "endColumn": 18
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 256,
        "column": 88,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 256,
        "endColumn": 91,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [8535, 8538], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [8535, 8538], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      }
    ],
    "suppressedMessages": [],
    "errorCount": 5,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import React from 'react'\nimport {\n  MessageSquare,\n  Settings,\n  Menu,\n  Plus,\n  Zap,\n  Trash2,\n  MessageCircleOff,\n  Brain,\n  Code,\n  PenTool,\n  Sparkles,\n  Smile,\n  Terminal,\n  Briefcase,\n  Coffee,\n  Music\n} from 'lucide-react'\nimport { ChatSession, Gem } from '../services/storage'\n\ninterface SidebarProps {\n  chats: ChatSession[]\n  gems: Gem[]\n  recentImages: string[]\n  activeId: string | null\n  onSelect: (id: string) => void\n  onDelete: (id: string, e: React.MouseEvent) => void\n  onNewChat: () => void\n  onOpenSettings: () => void\n  onOpenGemManager: () => void\n  onOpenGallery: () => void\n  onGoToImage: (src: string) => void\n  collapsed: boolean\n  onToggle: () => void\n}\n\nconst ICON_MAP = {\n  zap: Zap,\n  brain: Brain,\n  code: Code,\n  pen: PenTool,\n  sparkles: Sparkles,\n  smile: Smile,\n  terminal: Terminal,\n  briefcase: Briefcase,\n  coffee: Coffee,\n  music: Music\n}\n\nexport function Sidebar({\n  chats,\n  gems,\n  recentImages,\n  activeId,\n  onSelect,\n  onDelete,\n  onNewChat,\n  onOpenSettings,\n  onOpenGemManager,\n  onOpenGallery,\n  onGoToImage,\n  collapsed,\n  onToggle\n}: SidebarProps) {\n  // Group chats by Gem\n  const gemChats = (gemId: string) => chats.filter((c) => c.gemId === gemId)\n  // Chats without a Gem (Default section)\n  const generalChats = chats.filter((c) => !c.gemId)\n\n  const renderGemIcon = (iconName: string, size = 16, className = '') => {\n    const Icon = ICON_MAP[iconName] || Zap\n    return <Icon size={size} className={className} />\n  }\n\n  return (\n    <div\n      className={`${collapsed ? 'w-[68px]' : 'w-[280px]'} h-full bg-[#1e1f20] flex flex-col pt-4 drag-none font-sans text-[14px] transition-all duration-300 ease-in-out`}\n    >\n      {/* Header / Hamburger */}\n      <div\n        className={`px-4 mb-4 flex items-center ${collapsed ? 'justify-center' : 'justify-between'}`}\n      >\n        <button\n          onClick={onToggle}\n          className=\"p-2 text-gray-400 hover:text-white hover:bg-[#2c2d2e] rounded-full transition-colors\"\n          title={collapsed ? 'Expand sidebar' : 'Collapse sidebar'}\n        >\n          <Menu size={20} />\n        </button>\n      </div>\n\n      {/* New Chat Action */}\n      <div className={`px-3 mb-4 transition-all ${collapsed ? 'flex justify-center' : ''}`}>\n        <button\n          onClick={onNewChat}\n          className={`flex items-center gap-3 bg-[#2c2d2e] text-[#e3e3e3] rounded-full hover:bg-[#37383a] transition-all ${collapsed ? 'p-3 w-auto' : 'px-4 py-3 w-[140px]'}`}\n          title=\"New Chat\"\n        >\n          <Plus size={18} className=\"text-gray-300\" />\n          {!collapsed && <span className=\"font-medium text-sm\">New chat</span>}\n        </button>\n      </div>\n\n      {/* Scrollable Content */}\n      <div className=\"flex-1 overflow-y-auto px-2 space-y-6 custom-scrollbar\">\n        {/* My Stuff Section */}\n        <div>\n          {!collapsed && (\n            <div\n              className=\"px-4 py-2 flex items-center justify-between text-xs font-medium text-gray-500 mb-1 hover:text-gray-300 cursor-pointer transition-colors\"\n              onClick={onOpenGallery}\n            >\n              <span>My Stuff</span>\n              <MessageSquare size={12} className=\"opacity-0 group-hover:opacity-100\" />\n            </div>\n          )}\n\n          {/* Recent Images Preview Row */}\n          {!collapsed && recentImages.length > 0 && (\n            <div className=\"flex px-4 gap-2 mb-4 overflow-hidden\">\n              {recentImages.slice(0, 3).map((img, i) => (\n                <div\n                  key={i}\n                  className=\"w-16 h-16 rounded-lg bg-gray-800 border border-gray-700 overflow-hidden cursor-pointer hover:border-gray-500 transition-colors\"\n                  onClick={() => onGoToImage(img)}\n                >\n                  <img\n                    src={img}\n                    className=\"w-full h-full object-cover opacity-80 hover:opacity-100\"\n                  />\n                </div>\n              ))}\n            </div>\n          )}\n          {collapsed && (\n            <div className=\"flex justify-center mb-4\">\n              <button\n                onClick={onOpenGallery}\n                className=\"p-2 text-gray-400 hover:text-white rounded-full hover:bg-[#2c2d2e]\"\n                title=\"My Stuff Gallery\"\n              >\n                <MessageSquare size={20} />\n              </button>\n            </div>\n          )}\n        </div>\n\n        {/* Gems Section */}\n        {gems.length > 0 && (\n          <div>\n            {!collapsed && (\n              <div className=\"px-4 py-2 text-xs font-medium text-gray-500 mb-1\">Gems</div>\n            )}\n            <div className=\"space-y-4\">\n              {gems.map((gem) => {\n                const theseChats = gemChats(gem.id)\n                return (\n                  <div key={gem.id}>\n                    <div\n                      className={`flex items-center gap-2 ${collapsed ? 'justify-center p-2' : 'px-4 py-1 text-gray-300 mb-1'} `}\n                    >\n                      <div\n                        className={`text-[#f4b400] ${collapsed ? 'p-2 bg-[#2c2d2e] rounded-lg' : ''}`}\n                      >\n                        {renderGemIcon(gem.icon, collapsed ? 18 : 14)}\n                      </div>\n                      {!collapsed && (\n                        <span className=\"font-medium text-sm truncate\">{gem.name}</span>\n                      )}\n                    </div>\n                    <div className=\"space-y-0.5\">\n                      {theseChats.map((chat) => (\n                        <ChatItem\n                          key={chat.id}\n                          chat={chat}\n                          activeId={activeId}\n                          onSelect={onSelect}\n                          onDelete={onDelete}\n                          collapsed={collapsed}\n                          isNested={true}\n                        />\n                      ))}\n                      {theseChats.length === 0 && !collapsed && (\n                        <div className=\"px-4 py-1.5 text-xs text-gray-600 italic pl-6\">\n                          No chats yet\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                )\n              })}\n            </div>\n          </div>\n        )}\n\n        {/* Recent Chats Section (General) */}\n        <div>\n          {!collapsed && (\n            <div className=\"px-4 py-2 text-xs font-medium text-gray-500 mb-1\">Chats</div>\n          )}\n\n          {generalChats.length === 0 && gems.length === 0 ? (\n            !collapsed && (\n              <div className=\"px-4 py-8 text-center flex flex-col items-center opacity-40 select-none\">\n                <MessageCircleOff size={24} className=\"mb-2\" />\n                <span className=\"text-sm\">No chats available.</span>\n              </div>\n            )\n          ) : (\n            <div className=\"space-y-1\">\n              {generalChats.map((chat) => (\n                <ChatItem\n                  key={chat.id}\n                  chat={chat}\n                  activeId={activeId}\n                  onSelect={onSelect}\n                  onDelete={onDelete}\n                  collapsed={collapsed}\n                />\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Bottom Actions */}\n      <div className=\"mt-auto p-3 space-y-1\">\n        <button\n          onClick={onOpenGemManager}\n          className={`flex items-center gap-3 w-full text-left text-[#e3e3e3] hover:bg-[#2c2d2e] rounded-full transition-colors ${collapsed ? 'justify-center p-2.5' : 'px-4 py-2.5'}`}\n          title={collapsed ? 'Gem Manager' : undefined}\n        >\n          <Zap size={18} className=\"text-[#f4b400]\" />\n          {!collapsed && <span>Gem Manager</span>}\n        </button>\n        <button\n          onClick={onOpenSettings}\n          className={`flex items-center gap-3 w-full text-left text-[#e3e3e3] hover:bg-[#2c2d2e] rounded-full transition-colors ${collapsed ? 'justify-center p-2.5' : 'px-4 py-2.5'}`}\n          title={collapsed ? 'Settings' : undefined}\n        >\n          <Settings size={18} />\n          {!collapsed && <span>Settings</span>}\n        </button>\n        {!collapsed && (\n          <div className=\"px-4 py-2 text-xs text-gray-500 flex items-center gap-2 fade-in\">\n            <div className=\"w-2 h-2 rounded-full bg-green-500\"></div>\n            <span>Gemini Native</span>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\nfunction ChatItem({ chat, activeId, onSelect, onDelete, collapsed, isNested = false }: any) {\n  return (\n    <div\n      className={`group relative w-full flex items-center gap-3 rounded-full transition-colors cursor-pointer ${\n        collapsed ? 'justify-center p-2' : `py-2 ${isNested ? 'pl-6 pr-4' : 'px-4'}`\n      } ${\n        activeId === chat.id ? 'bg-[#004a77] text-[#c2e7ff]' : 'text-[#e3e3e3] hover:bg-[#2c2d2e]'\n      }`}\n      onClick={() => onSelect(chat.id)}\n      title={collapsed ? chat.title : undefined}\n    >\n      <MessageSquare\n        size={16}\n        className={`${activeId === chat.id ? 'text-[#c2e7ff]' : 'text-gray-500 group-hover:text-gray-300'}`}\n      />\n      {!collapsed && (\n        <>\n          <span className=\"truncate pr-6 text-sm flex-1\">{chat.title}</span>\n          <button\n            className=\"absolute right-2 p-1.5 opacity-0 group-hover:opacity-100 hover:text-red-400 text-gray-400 transition-all rounded-full hover:bg-gray-700/50\"\n            onClick={(e) => {\n              e.stopPropagation()\n              onDelete(chat.id, e)\n            }}\n            title=\"Delete Chat\"\n          >\n            <Trash2 size={13} />\n          </button>\n        </>\n      )}\n    </div>\n  )\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\components\\Versions.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\constants\\models.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\env.d.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\main.tsx",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\services\\gemini.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 12,
        "column": 3,
        "nodeType": "FunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 12,
        "endColumn": 19
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 40,
        "column": 3,
        "nodeType": "FunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 40,
        "endColumn": 20
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 52,
        "column": 3,
        "nodeType": "FunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 52,
        "endColumn": 26
      }
    ],
    "suppressedMessages": [],
    "errorCount": 3,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { GoogleGenerativeAI, Content } from '@google/generative-ai'\n\nexport class GeminiService {\n  private genAI: GoogleGenerativeAI\n  private modelName: string\n\n  constructor(apiKey: string, modelName: string = 'gemini-1.5-flash') {\n    this.genAI = new GoogleGenerativeAI(apiKey)\n    this.modelName = modelName\n  }\n\n  async streamChat(message: string, history: Content[], systemInstruction?: string) {\n    let modelName = this.modelName\n    let thinkingConfig = {}\n\n    // Special handling for \"Thinking\" pseudo-model\n    if (this.modelName === 'gemini-3-pro-preview-thinking') {\n      modelName = 'gemini-3-pro-preview'\n      // @ts-ignore - SDK might not have strict typing for this yet\n      thinkingConfig = { thinking_level: 'high' }\n    }\n\n    const model = this.genAI.getGenerativeModel({\n      model: modelName,\n      systemInstruction: systemInstruction,\n      ...thinkingConfig\n    })\n\n    const chat = model.startChat({\n      history: history,\n      generationConfig: {\n        maxOutputTokens: 8000\n      }\n    })\n\n    const result = await chat.sendMessageStream(message)\n    return result.stream\n  }\n\n  async validateKey() {\n    try {\n      // Simple test\n      const model = this.genAI.getGenerativeModel({ model: 'gemini-1.5-flash' })\n      await model.generateContent('ping')\n      return true\n    } catch (e) {\n      console.error(e)\n      return false\n    }\n  }\n\n  static async listModels(apiKey: string) {\n    try {\n      const response = await fetch(\n        `https://generativelanguage.googleapis.com/v1beta/models?key=${apiKey}`\n      )\n      if (!response.ok) {\n        throw new Error(`Failed to list models: ${response.statusText}`)\n      }\n      const data = await response.json()\n      return data.models || []\n    } catch (error) {\n      console.error('Error listing models:', error)\n      return []\n    }\n  }\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\services\\storage.ts",
    "messages": [
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 64,
        "column": 32,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 64,
        "endColumn": 35,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1287, 1290], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1287, 1290], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 74,
        "column": 47,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 74,
        "endColumn": 50,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [1551, 1554], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [1551, 1554], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'e' is defined but never used.",
        "line": 80,
        "column": 14,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 80,
        "endColumn": 15
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'e' is defined but never used.",
        "line": 103,
        "column": 14,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 103,
        "endColumn": 15
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 109,
        "column": 3,
        "nodeType": "FunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 109,
        "endColumn": 19
      },
      {
        "ruleId": "@typescript-eslint/no-explicit-any",
        "severity": 2,
        "message": "Unexpected any. Specify a different type.",
        "line": 115,
        "column": 17,
        "nodeType": "TSAnyKeyword",
        "messageId": "unexpectedAny",
        "endLine": 115,
        "endColumn": 20,
        "suggestions": [
          {
            "messageId": "suggestUnknown",
            "fix": { "range": [2586, 2589], "text": "unknown" },
            "desc": "Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."
          },
          {
            "messageId": "suggestNever",
            "fix": { "range": [2586, 2589], "text": "never" },
            "desc": "Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."
          }
        ]
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 138,
        "column": 3,
        "nodeType": "FunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 138,
        "endColumn": 17
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 144,
        "column": 3,
        "nodeType": "FunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 144,
        "endColumn": 20
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 158,
        "column": 3,
        "nodeType": "FunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 158,
        "endColumn": 20
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'e' is defined but never used.",
        "line": 189,
        "column": 14,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 189,
        "endColumn": 15
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 195,
        "column": 3,
        "nodeType": "FunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 195,
        "endColumn": 22
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'e' is defined but never used.",
        "line": 217,
        "column": 14,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 217,
        "endColumn": 15
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 223,
        "column": 3,
        "nodeType": "FunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 223,
        "endColumn": 18
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 230,
        "column": 3,
        "nodeType": "FunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 230,
        "endColumn": 16
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 236,
        "column": 3,
        "nodeType": "FunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 236,
        "endColumn": 19
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 241,
        "column": 3,
        "nodeType": "FunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 241,
        "endColumn": 19
      },
      {
        "ruleId": "@typescript-eslint/no-unused-vars",
        "severity": 2,
        "message": "'e' is defined but never used.",
        "line": 267,
        "column": 14,
        "nodeType": null,
        "messageId": "unusedVar",
        "endLine": 267,
        "endColumn": 15
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 273,
        "column": 3,
        "nodeType": "FunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 273,
        "endColumn": 29
      },
      {
        "ruleId": "@typescript-eslint/explicit-function-return-type",
        "severity": 2,
        "message": "Missing return type on function.",
        "line": 280,
        "column": 3,
        "nodeType": "FunctionExpression",
        "messageId": "missingReturnType",
        "endLine": 280,
        "endColumn": 27
      }
    ],
    "suppressedMessages": [],
    "errorCount": 19,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "source": "import { ChatMessage } from '../types'\nimport CryptoJS from 'crypto-js'\n\nconst SECRET_KEY = 'gemini-native-local-storage-secret'\n\nexport interface GeneratedAsset {\n  id: string\n  type: 'image' | 'video'\n  path: string\n  prompt: string\n  chatId: string\n  messageId: string\n  timestamp: number\n  modelId: string\n}\n\nexport interface ChatMessage {\n  id: string\n  role: 'user' | 'model'\n  text: string\n  timestamp: number\n  images?: string[]\n  generatedAssets?: GeneratedAsset[] // Metadata for generated content\n}\n\nexport interface ChatSession {\n  id: string\n  title: string\n  messages: ChatMessage[]\n  updatedAt: number\n  modelId?: string // Per-chat model override\n  gemId?: string // Optional: Linked Gem ID\n}\n\nexport interface ApiKey {\n  id: string\n  name: string\n  key: string\n}\n\nexport interface AppSettings {\n  apiKeys: ApiKey[]\n  activeKeyId: string\n  activeModel: string\n  theme: 'dark' | 'light'\n  username?: string\n  globalInstructions?: string\n}\n\nexport interface Gem {\n  id: string\n  name: string\n  icon: string\n  instruction: string\n}\n\nexport class StorageService {\n  private static CHATS_KEY = 'gemini_chats_encrypted'\n  private static SETTINGS_KEY = 'gemini_settings'\n  private static GEMS_KEY = 'gemini_gems'\n\n  // --- ENCRYPTION HELPERS ---\n\n  private static encrypt(data: any): string {\n    try {\n      const json = JSON.stringify(data)\n      return CryptoJS.AES.encrypt(json, SECRET_KEY).toString()\n    } catch (e) {\n      console.error('Encryption failed:', e)\n      return ''\n    }\n  }\n\n  private static decrypt(ciphertext: string): any {\n    try {\n      const bytes = CryptoJS.AES.decrypt(ciphertext, SECRET_KEY)\n      const decrypted = bytes.toString(CryptoJS.enc.Utf8)\n      if (!decrypted) return null\n      return JSON.parse(decrypted)\n    } catch (e) {\n      return null\n    }\n  }\n\n  // --- CHATS ---\n\n  static getChats(): ChatSession[] {\n    const raw = localStorage.getItem(this.CHATS_KEY)\n    if (!raw) return []\n\n    // Try decrypting first\n    const decrypted = this.decrypt(raw)\n    if (decrypted) return decrypted\n\n    // Fallback: try parsing raw (migration from plain text)\n    try {\n      const plain = JSON.parse(raw)\n      // If we successfully read plain text, re-save as encrypted immediately\n      if (Array.isArray(plain)) {\n        this.saveChats(plain)\n        return plain\n      }\n    } catch (e) {\n      // Ignore\n    }\n    return []\n  }\n\n  static saveChats(chats: ChatSession[]) {\n    try {\n      const ciphertext = this.encrypt(chats)\n      if (ciphertext) {\n        localStorage.setItem(this.CHATS_KEY, ciphertext)\n      }\n    } catch (e: any) {\n      console.error('Storage quota exceeded:', e)\n      // Fallback: Try saving without images (heavy base64 data)\n      try {\n        const liteChats = chats.map((chat) => ({\n          ...chat,\n          messages: chat.messages.map((msg) => ({\n            role: msg.role,\n            content: msg.content,\n            // Strip images to save space\n            images: undefined\n          }))\n        }))\n        const liteCiphertext = this.encrypt(liteChats)\n        if (liteCiphertext) {\n          localStorage.setItem(this.CHATS_KEY, liteCiphertext)\n        }\n      } catch (retryError) {\n        console.error('Failed to save even lite version:', retryError)\n      }\n    }\n  }\n\n  static addChat(chat: ChatSession) {\n    const chats = this.getChats()\n    chats.unshift(chat)\n    this.saveChats(chats)\n  }\n\n  static updateChat(id: string, messages: ChatMessage[], title?: string, modelId?: string) {\n    const chats = this.getChats()\n    const index = chats.findIndex((c) => c.id === id)\n    if (index !== -1) {\n      chats[index].messages = messages\n      chats[index].updatedAt = Date.now()\n      if (title) chats[index].title = title\n      if (modelId) chats[index].modelId = modelId\n      const updated = chats.splice(index, 1)[0]\n      chats.unshift(updated)\n      this.saveChats(chats)\n    }\n  }\n\n  static deleteChat(id: string) {\n    const chats = this.getChats().filter((c) => c.id !== id)\n    this.saveChats(chats)\n  }\n\n  // --- SETTINGS ---\n\n  static getSettings(): AppSettings {\n    const raw = localStorage.getItem(this.SETTINGS_KEY)\n    const defaultSettings: AppSettings = {\n      apiKeys: [],\n      activeKeyId: '',\n      activeModel: 'gemini-2.5-flash',\n      theme: 'dark',\n      username: 'User',\n      globalInstructions: ''\n    }\n\n    if (!raw) return defaultSettings\n\n    // Try decrypting\n    const decrypted = this.decrypt(raw)\n    if (decrypted) return decrypted\n\n    // Fallback: try parsing raw\n    try {\n      const plain = JSON.parse(raw)\n      if (plain && typeof plain === 'object') {\n        this.saveSettings(plain) // Migrate to encrypted\n        return plain\n      }\n    } catch (e) {\n      // Ignore\n    }\n    return defaultSettings\n  }\n\n  static saveSettings(settings: AppSettings) {\n    const ciphertext = this.encrypt(settings)\n    if (ciphertext) {\n      localStorage.setItem(this.SETTINGS_KEY, ciphertext)\n    }\n  }\n\n  // --- GEMS (System Prompts) ---\n\n  static getGems(): Gem[] {\n    const raw = localStorage.getItem(this.GEMS_KEY)\n    if (!raw) return []\n\n    const decrypted = this.decrypt(raw)\n    if (decrypted) return decrypted\n\n    try {\n      const plain = JSON.parse(raw)\n      if (Array.isArray(plain)) {\n        this.saveGems(plain)\n        return plain\n      }\n    } catch (e) {\n      // Ignore\n    }\n    return []\n  }\n\n  static saveGems(gems: Gem[]) {\n    const ciphertext = this.encrypt(gems)\n    if (ciphertext) {\n      localStorage.setItem(this.GEMS_KEY, ciphertext)\n    }\n  }\n\n  static addGem(gem: Gem) {\n    const gems = this.getGems()\n    gems.push(gem)\n    this.saveGems(gems)\n  }\n\n  static deleteGem(id: string) {\n    const gems = this.getGems().filter((g) => g.id !== id)\n    this.saveGems(gems)\n  }\n\n  static updateGem(updatedGem: Gem) {\n    const gems = this.getGems()\n    const index = gems.findIndex((g) => g.id === updatedGem.id)\n    if (index !== -1) {\n      gems[index] = updatedGem\n      this.saveGems(gems)\n    }\n  }\n\n  private static GENERATED_ASSETS_KEY = 'gemini_generated_assets'\n\n  // --- GENERATED ASSETS ---\n\n  static getGeneratedAssets(): GeneratedAsset[] {\n    const raw = localStorage.getItem(this.GENERATED_ASSETS_KEY)\n    if (!raw) return []\n\n    const decrypted = this.decrypt(raw)\n    if (decrypted) return decrypted\n\n    try {\n      const plain = JSON.parse(raw)\n      if (Array.isArray(plain)) {\n        this.saveGeneratedAssets(plain)\n        return plain\n      }\n    } catch (e) {\n      // Ignore\n    }\n    return []\n  }\n\n  static saveGeneratedAssets(assets: GeneratedAsset[]) {\n    const ciphertext = this.encrypt(assets)\n    if (ciphertext) {\n      localStorage.setItem(this.GENERATED_ASSETS_KEY, ciphertext)\n    }\n  }\n\n  static addGeneratedAsset(asset: GeneratedAsset) {\n    const assets = this.getGeneratedAssets()\n    assets.unshift(asset)\n    this.saveGeneratedAssets(assets)\n  }\n}\n",
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\types.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\src\\renderer\\src\\webview.d.ts",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  },
  {
    "filePath": "C:\\Users\\admin\\Downloads\\gemapp\\gemapp\\tailwind.config.js",
    "messages": [],
    "suppressedMessages": [],
    "errorCount": 0,
    "fatalErrorCount": 0,
    "warningCount": 0,
    "fixableErrorCount": 0,
    "fixableWarningCount": 0,
    "usedDeprecatedRules": []
  }
]
